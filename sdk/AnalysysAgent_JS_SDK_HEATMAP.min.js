(function (factory) {
  typeof define === 'function' && define.amd ? define(factory) :
  factory();
}((function () { 'use strict';

  var _keyStr = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';

  function _utf8Encode(string) {
    string = string.replace(/\r\n/g, '\n');
    var utftext = '';

    for (var n = 0; n < string.length; n++) {
      var c = string.charCodeAt(n);

      if (c < 128) {
        utftext += String.fromCharCode(c);
      } else if (c > 127 && c < 2048) {
        utftext += String.fromCharCode(c >> 6 | 192);
        utftext += String.fromCharCode(c & 63 | 128);
      } else {
        utftext += String.fromCharCode(c >> 12 | 224);
        utftext += String.fromCharCode(c >> 6 & 63 | 128);
        utftext += String.fromCharCode(c & 63 | 128);
      }
    }

    return utftext;
  }

  function _utf8Decode(utftext) {
    var string = '';
    var i = 0;
    var c = 0;
    var c2 = 0;
    var c3 = 0;

    while (i < utftext.length) {
      c = utftext.charCodeAt(i);

      if (c < 128) {
        string += String.fromCharCode(c);
        i++;
      } else if (c > 191 && c < 224) {
        c2 = utftext.charCodeAt(i + 1);
        string += String.fromCharCode((c & 31) << 6 | c2 & 63);
        i += 2;
      } else {
        c2 = utftext.charCodeAt(i + 1);
        c3 = utftext.charCodeAt(i + 2);
        string += String.fromCharCode((c & 15) << 12 | (c2 & 63) << 6 | c3 & 63);
        i += 3;
      }
    }

    return string;
  }

  function Util() {}

  Util.prototype.paramType = function (param) {
    return Object.prototype.toString.call(param).replace('[object ', '').replace(']', '');
  };

  Util.prototype.objHasKay = function (obj, key) {
    return Object.prototype.hasOwnProperty.call(obj, key);
  };

  Util.prototype.ArrayToObj = function (arr) {
    var obj = {};

    for (var i = 0; i < arr.length; i++) {
      obj[arr[i]] = '';
    }

    return obj;
  };

  Util.prototype.keyValueToObje = function (key, value) {
    var obj = {};
    obj[key] = value;
    return obj;
  };

  Util.prototype.toDeepObj = function (param1, param2) {
    var obj = {};

    if (this.paramType(param1) === 'String') {
      obj = this.keyValueToObje(param1, param2);
      return obj;
    }

    if (this.paramType(param1) === 'Array') {
      obj = this.ArrayToObj(param1);
      return obj;
    }

    if (this.paramType(param1) === 'Object') {
      for (var key in param1) {
        obj[key] = this.toDeepObj(param1[key]);
      }
    }

    return obj;
  };

  Util.prototype.toObj = function (param1, param2) {
    var obj = {};

    if (this.paramType(param1) === 'String') {
      obj = this.keyValueToObje(param1, param2);
      return obj;
    }

    if (this.paramType(param1) === 'Array') {
      obj = this.ArrayToObj(param1);
      return obj;
    }

    if (this.paramType(param1) === 'Object') {
      return param1;
    }

    return obj;
  };

  Util.prototype.objMerge = function (parentObj, part) {
    if (this.paramType(parentObj) !== 'Object' || this.paramType(part) !== 'Object') {
      return parentObj;
    }

    var obj = {};

    for (var key in parentObj) {
      obj[key] = parentObj[key];
    }

    for (var partKey in part) {
      var partValue = part[partKey];
      var objValue = obj[partKey];
      var partValueType = this.paramType(partValue);
      var objValueType = this.paramType(objValue);

      if (objValue && objValueType === 'Object' && partValueType === 'Object') {
        obj[partKey] = this.objMerge(objValue, partValue);
      } else if (objValueType === 'Array' && partValueType === 'Array') {
        obj[partKey] = this.arrayMergeUnique(objValue, partValue);
      } else if (partValueType === 'Function' && objValueType === 'Function') {
        obj[partKey] = this.compose(objValue, partValue);
      } else {
        obj[partKey] = partValue;
      }
    }

    return obj;
  };

  Util.prototype.compose = function () {
    var args = arguments;
    var start = args.length - 1;
    return function () {
      var i = start;
      var result = args[start].apply(this, arguments);

      while (i--) result = args[i].call(this, result);

      return result;
    };
  };

  Util.prototype.fnMerge = function (parentObj, part) {
    return this.objMerge(parentObj, part);
  };

  Util.prototype.arrayUnique = function (arr) {
    var tmpArr = [];
    var hash = {}; // hash为hash表

    for (var i = 0; i < arr.length; i++) {
      if (!hash[arr[i]]) {
        // 如果hash表中没有当前项
        hash[arr[i]] = true; // 存入hash表

        tmpArr.push(arr[i]); // 存入临时数组
      }
    }

    return tmpArr;
  };

  Util.prototype.arrayMerge = function (arr1, arr2) {
    arr1.push.apply(arr1, arr2);
    return arr1;
  };

  Util.prototype.arrayMergeUnique = function (arr1, arr2) {
    arr1.push.apply(arr1, arr2);
    return this.arrayUnique(arr1);
  };

  Util.prototype.encode = function (input) {
    var output = '';
    var chr1;
    var chr2;
    var chr3;
    var enc1;
    var enc2;
    var enc3;
    var enc4;
    var i = 0;
    input = _utf8Encode(input);

    while (i < input.length) {
      chr1 = input.charCodeAt(i++);
      chr2 = input.charCodeAt(i++);
      chr3 = input.charCodeAt(i++);
      enc1 = chr1 >> 2;
      enc2 = (chr1 & 3) << 4 | chr2 >> 4;
      enc3 = (chr2 & 15) << 2 | chr3 >> 6;
      enc4 = chr3 & 63;

      if (isNaN(chr2)) {
        enc3 = enc4 = 64;
      } else if (isNaN(chr3)) {
        enc4 = 64;
      }

      output = output + _keyStr.charAt(enc1) + _keyStr.charAt(enc2) + _keyStr.charAt(enc3) + _keyStr.charAt(enc4);
    }

    return output;
  };

  Util.prototype.decode = function (input) {
    var output = '';
    var chr1;
    var chr2;
    var chr3;
    var enc1;
    var enc2;
    var enc3;
    var enc4;
    var i = 0;
    input = input.replace(/[^A-Za-z0-9+/=]/g, '');

    while (i < input.length) {
      enc1 = _keyStr.indexOf(input.charAt(i++));
      enc2 = _keyStr.indexOf(input.charAt(i++));
      enc3 = _keyStr.indexOf(input.charAt(i++));
      enc4 = _keyStr.indexOf(input.charAt(i++));
      chr1 = enc1 << 2 | enc2 >> 4;
      chr2 = (enc2 & 15) << 4 | enc3 >> 2;
      chr3 = (enc3 & 3) << 6 | enc4;
      output = output + String.fromCharCode(chr1);

      if (enc3 !== 64) {
        output = output + String.fromCharCode(chr2);
      }

      if (enc4 !== 64) {
        output = output + String.fromCharCode(chr3);
      }
    }

    output = _utf8Decode(output);
    return output;
  };

  Util.prototype.isEmptyObject = function (obj) {
    var name;

    for (name in obj) {
      return false;
    }

    return true;
  };

  Util.prototype.format = function (time, format) {
    var offsetGMT = time.getTimezoneOffset();
    time = new Date(time.getTime() + offsetGMT * 60 * 1000 + 8 * 60 * 60 * 1000); // 转换为东八区时间

    var o = {
      'M+': time.getMonth() + 1,
      // month
      'd+': time.getDate(),
      // day
      'h+': time.getHours(),
      // hour
      'm+': time.getMinutes(),
      // minute
      's+': time.getSeconds(),
      // second
      'q+': Math.floor((time.getMonth() + 3) / 3),
      // quarter
      'S+': time.getMilliseconds() // millisecond

    };

    if (/(y+)/.test(format)) {
      format = format.replace(RegExp.$1, (time.getFullYear() + '').substr(4 - RegExp.$1.length));
    }

    for (var k in o) {
      if (new RegExp('(' + k + ')').test(format)) {
        format = format.replace(RegExp.$1, RegExp.$1.length === 3 ? ('' + o[k]).length < 3 ? ('00' + o[k]).substr(('00' + o[k]).length - 3, ('00' + o[k]).length) : o[k] : ('00' + o[k]).substr(('' + o[k]).length));
      }
    }

    return format;
  };

  Util.prototype.MD5 = function (value, bit) {
    var sMessage = value;

    function RotateLeft(lValue, iShiftBits) {
      return lValue << iShiftBits | lValue >>> 32 - iShiftBits;
    }

    function AddUnsigned(lX, lY) {
      var lX4, lY4, lX8, lY8, lResult;
      lX8 = lX & 0x80000000;
      lY8 = lY & 0x80000000;
      lX4 = lX & 0x40000000;
      lY4 = lY & 0x40000000;
      lResult = (lX & 0x3FFFFFFF) + (lY & 0x3FFFFFFF);
      if (lX4 & lY4) return lResult ^ 0x80000000 ^ lX8 ^ lY8;

      if (lX4 | lY4) {
        if (lResult & 0x40000000) return lResult ^ 0xC0000000 ^ lX8 ^ lY8;else return lResult ^ 0x40000000 ^ lX8 ^ lY8;
      } else return lResult ^ lX8 ^ lY8;
    }

    function F(x, y, z) {
      return x & y | ~x & z;
    }

    function G(x, y, z) {
      return x & z | y & ~z;
    }

    function H(x, y, z) {
      return x ^ y ^ z;
    }

    function I(x, y, z) {
      return y ^ (x | ~z);
    }

    function FF(a, b, c, d, x, s, ac) {
      a = AddUnsigned(a, AddUnsigned(AddUnsigned(F(b, c, d), x), ac));
      return AddUnsigned(RotateLeft(a, s), b);
    }

    function GG(a, b, c, d, x, s, ac) {
      a = AddUnsigned(a, AddUnsigned(AddUnsigned(G(b, c, d), x), ac));
      return AddUnsigned(RotateLeft(a, s), b);
    }

    function HH(a, b, c, d, x, s, ac) {
      a = AddUnsigned(a, AddUnsigned(AddUnsigned(H(b, c, d), x), ac));
      return AddUnsigned(RotateLeft(a, s), b);
    }

    function II(a, b, c, d, x, s, ac) {
      a = AddUnsigned(a, AddUnsigned(AddUnsigned(I(b, c, d), x), ac));
      return AddUnsigned(RotateLeft(a, s), b);
    }

    function ConvertToWordArray(sMessage) {
      var lWordCount;
      var lMessageLength = sMessage.length;
      var lNumberOfWordsTemp1 = lMessageLength + 8;
      var lNumberOfWordsTemp2 = (lNumberOfWordsTemp1 - lNumberOfWordsTemp1 % 64) / 64;
      var lNumberOfWords = (lNumberOfWordsTemp2 + 1) * 16;
      var lWordArray = Array(lNumberOfWords - 1);
      var lBytePosition = 0;
      var lByteCount = 0;

      while (lByteCount < lMessageLength) {
        lWordCount = (lByteCount - lByteCount % 4) / 4;
        lBytePosition = lByteCount % 4 * 8;
        lWordArray[lWordCount] = lWordArray[lWordCount] | sMessage.charCodeAt(lByteCount) << lBytePosition;
        lByteCount++;
      }

      lWordCount = (lByteCount - lByteCount % 4) / 4;
      lBytePosition = lByteCount % 4 * 8;
      lWordArray[lWordCount] = lWordArray[lWordCount] | 0x80 << lBytePosition;
      lWordArray[lNumberOfWords - 2] = lMessageLength << 3;
      lWordArray[lNumberOfWords - 1] = lMessageLength >>> 29;
      return lWordArray;
    }

    function WordToHex(lValue) {
      var WordToHexValue = '';
      var WordToHexValueTemp = '';
      var lByte;
      var lCount;

      for (lCount = 0; lCount <= 3; lCount++) {
        lByte = lValue >>> lCount * 8 & 255;
        WordToHexValueTemp = '0' + lByte.toString(16);
        WordToHexValue = WordToHexValue + WordToHexValueTemp.substr(WordToHexValueTemp.length - 2, 2);
      }

      return WordToHexValue;
    }

    var x = [];
    var k, AA, BB, CC, DD, a, b, c, d;
    var S11 = 7;
    var S12 = 12;
    var S13 = 17;
    var S14 = 22;
    var S21 = 5;
    var S22 = 9;
    var S23 = 14;
    var S24 = 20;
    var S31 = 4;
    var S32 = 11;
    var S33 = 16;
    var S34 = 23;
    var S41 = 6;
    var S42 = 10;
    var S43 = 15;
    var S44 = 21; // Steps 1 and 2. Append padding bits and length and convert to words

    x = ConvertToWordArray(sMessage); // Step 3. Initialise

    a = 0x67452301;
    b = 0xEFCDAB89;
    c = 0x98BADCFE;
    d = 0x10325476; // Step 4. Process the message in 16-word blocks

    for (k = 0; k < x.length; k += 16) {
      AA = a;
      BB = b;
      CC = c;
      DD = d;
      a = FF(a, b, c, d, x[k + 0], S11, 0xD76AA478);
      d = FF(d, a, b, c, x[k + 1], S12, 0xE8C7B756);
      c = FF(c, d, a, b, x[k + 2], S13, 0x242070DB);
      b = FF(b, c, d, a, x[k + 3], S14, 0xC1BDCEEE);
      a = FF(a, b, c, d, x[k + 4], S11, 0xF57C0FAF);
      d = FF(d, a, b, c, x[k + 5], S12, 0x4787C62A);
      c = FF(c, d, a, b, x[k + 6], S13, 0xA8304613);
      b = FF(b, c, d, a, x[k + 7], S14, 0xFD469501);
      a = FF(a, b, c, d, x[k + 8], S11, 0x698098D8);
      d = FF(d, a, b, c, x[k + 9], S12, 0x8B44F7AF);
      c = FF(c, d, a, b, x[k + 10], S13, 0xFFFF5BB1);
      b = FF(b, c, d, a, x[k + 11], S14, 0x895CD7BE);
      a = FF(a, b, c, d, x[k + 12], S11, 0x6B901122);
      d = FF(d, a, b, c, x[k + 13], S12, 0xFD987193);
      c = FF(c, d, a, b, x[k + 14], S13, 0xA679438E);
      b = FF(b, c, d, a, x[k + 15], S14, 0x49B40821);
      a = GG(a, b, c, d, x[k + 1], S21, 0xF61E2562);
      d = GG(d, a, b, c, x[k + 6], S22, 0xC040B340);
      c = GG(c, d, a, b, x[k + 11], S23, 0x265E5A51);
      b = GG(b, c, d, a, x[k + 0], S24, 0xE9B6C7AA);
      a = GG(a, b, c, d, x[k + 5], S21, 0xD62F105D);
      d = GG(d, a, b, c, x[k + 10], S22, 0x2441453);
      c = GG(c, d, a, b, x[k + 15], S23, 0xD8A1E681);
      b = GG(b, c, d, a, x[k + 4], S24, 0xE7D3FBC8);
      a = GG(a, b, c, d, x[k + 9], S21, 0x21E1CDE6);
      d = GG(d, a, b, c, x[k + 14], S22, 0xC33707D6);
      c = GG(c, d, a, b, x[k + 3], S23, 0xF4D50D87);
      b = GG(b, c, d, a, x[k + 8], S24, 0x455A14ED);
      a = GG(a, b, c, d, x[k + 13], S21, 0xA9E3E905);
      d = GG(d, a, b, c, x[k + 2], S22, 0xFCEFA3F8);
      c = GG(c, d, a, b, x[k + 7], S23, 0x676F02D9);
      b = GG(b, c, d, a, x[k + 12], S24, 0x8D2A4C8A);
      a = HH(a, b, c, d, x[k + 5], S31, 0xFFFA3942);
      d = HH(d, a, b, c, x[k + 8], S32, 0x8771F681);
      c = HH(c, d, a, b, x[k + 11], S33, 0x6D9D6122);
      b = HH(b, c, d, a, x[k + 14], S34, 0xFDE5380C);
      a = HH(a, b, c, d, x[k + 1], S31, 0xA4BEEA44);
      d = HH(d, a, b, c, x[k + 4], S32, 0x4BDECFA9);
      c = HH(c, d, a, b, x[k + 7], S33, 0xF6BB4B60);
      b = HH(b, c, d, a, x[k + 10], S34, 0xBEBFBC70);
      a = HH(a, b, c, d, x[k + 13], S31, 0x289B7EC6);
      d = HH(d, a, b, c, x[k + 0], S32, 0xEAA127FA);
      c = HH(c, d, a, b, x[k + 3], S33, 0xD4EF3085);
      b = HH(b, c, d, a, x[k + 6], S34, 0x4881D05);
      a = HH(a, b, c, d, x[k + 9], S31, 0xD9D4D039);
      d = HH(d, a, b, c, x[k + 12], S32, 0xE6DB99E5);
      c = HH(c, d, a, b, x[k + 15], S33, 0x1FA27CF8);
      b = HH(b, c, d, a, x[k + 2], S34, 0xC4AC5665);
      a = II(a, b, c, d, x[k + 0], S41, 0xF4292244);
      d = II(d, a, b, c, x[k + 7], S42, 0x432AFF97);
      c = II(c, d, a, b, x[k + 14], S43, 0xAB9423A7);
      b = II(b, c, d, a, x[k + 5], S44, 0xFC93A039);
      a = II(a, b, c, d, x[k + 12], S41, 0x655B59C3);
      d = II(d, a, b, c, x[k + 3], S42, 0x8F0CCC92);
      c = II(c, d, a, b, x[k + 10], S43, 0xFFEFF47D);
      b = II(b, c, d, a, x[k + 1], S44, 0x85845DD1);
      a = II(a, b, c, d, x[k + 8], S41, 0x6FA87E4F);
      d = II(d, a, b, c, x[k + 15], S42, 0xFE2CE6E0);
      c = II(c, d, a, b, x[k + 6], S43, 0xA3014314);
      b = II(b, c, d, a, x[k + 13], S44, 0x4E0811A1);
      a = II(a, b, c, d, x[k + 4], S41, 0xF7537E82);
      d = II(d, a, b, c, x[k + 11], S42, 0xBD3AF235);
      c = II(c, d, a, b, x[k + 2], S43, 0x2AD7D2BB);
      b = II(b, c, d, a, x[k + 9], S44, 0xEB86D391);
      a = AddUnsigned(a, AA);
      b = AddUnsigned(b, BB);
      c = AddUnsigned(c, CC);
      d = AddUnsigned(d, DD);
    }

    if (bit === 32) {
      return WordToHex(a) + WordToHex(b) + WordToHex(c) + WordToHex(d);
    } else {
      return WordToHex(b) + WordToHex(c);
    }
  };

  Util.prototype.clientTimeZone = function () {
    var munites = new Date().getTimezoneOffset();
    var hour = parseInt(munites / 60);
    var munite = munites % 60;
    var prefix = '-';

    if (hour <= 0 || munite < 0) {
      prefix = '+';
      hour = -hour;

      if (munite < 0) {
        munite = -munite;
      }
    }

    hour = hour + '';
    munite = munite + '';

    if (hour.length === 1) {
      hour = '0' + hour;
    }

    if (munite.length === 1) {
      munite = '0' + munite;
    }

    return prefix + hour + ':' + munite;
  };

  Util.prototype.delEmpty = function (obj) {
    var newObj = {};

    for (var key in obj) {
      var inType = true;
      var valueType = this.paramType(obj[key]);

      if (valueType !== 'Object') {
        if (!obj[key] && (valueType !== 'Number' || isNaN(obj[key])) && valueType !== 'Boolean') {
          inType = false;
        }

        if (inType === true) {
          newObj[key] = obj[key];
        }
      } else {
        newObj[key] = this.delEmpty(obj[key]);
      }
    }

    for (var newObjKey in newObj) {
      var values = [];

      for (var key1 in newObj[newObjKey]) {
        values.push(newObj[newObjKey][key1]);
      }

      if (values.length === 0 && newObj[newObjKey].constructor === Object) {
        delete newObj[newObjKey];
      }
    }

    return newObj;
  };

  Util.prototype.addEvent = function (el, type, fn, useCapture) {
    if (document.addEventListener) {
      if (this.paramType(el) === 'Array' && el.length && el !== window) {
        for (var i = 0; i < el.length; i++) {
          this.addEvent(el[i], type, fn, useCapture);
        }
      } else {
        el.addEventListener(type, fn, useCapture);
      }
    } else {
      if (el.length && el !== window) {
        for (var index = 0; index < el.length; index++) {
          this.addEvent(el[index], type, fn);
        }
      } else {
        el.attachEvent('on' + type, function () {
          return fn.call(el, window.event);
        });
      }
    }
  };

  Util.prototype.removeEvent = function (el, type, fn, useCapture) {
    if (document.removeEventListener) {
      if (el.length) {
        for (var i = 0; i < el.length; i++) {
          this.removeEvent(el[i], type, fn, useCapture);
        }
      } else {
        el.removeEventListener(type, fn, useCapture);
      }
    } else {
      if (el.length) {
        for (var index = 0; index < el.length; index++) {
          this.removeEvent(el[index], type, fn);
        }
      } else {
        el.detachEvent('on' + type, function () {
          return fn.call(el, window.event);
        });
      }
    }
  };

  Util.prototype.addWindowEvent = function (type) {
    var orig = window.history[type];
    return function () {
      var rv = orig.apply(this, arguments);

      if (!document.createEvent) {
        // IE浏览器支持fireEvent方法
        var evt = document.createEventObject();
        evt.arguments = arguments;
        document.fireEvent('on' + type, evt);
      } else {
        // 其他标准浏览器使用dispatchEvent方法
        var evtEvent = document.createEvent('HTMLEvents');
        evtEvent.initEvent(type, true, true);
        evtEvent.arguments = arguments;
        window.dispatchEvent(evtEvent);
      }

      return rv;
    };
  };

  Util.prototype.extend = function (subClass, superClass) {
    var F = function () {};

    F.prototype = superClass.prototype;
    subClass.prototype = new F();
    subClass.prototype.constructor = subClass;
    subClass.superclass = superClass.prototype;

    if (superClass.prototype.constructor === Object.prototype.constructor) {
      superClass.prototype.constructor = superClass;
    }
  };

  Util.prototype.addEleLable = function (eleName, className, id, parent) {
    var dom = document;
    var createEle = dom.createElement(eleName);
    var domBody = parent || dom.body || dom.getElementsByTagName('body')[0];

    if (id) {
      createEle.id = id;
    }

    if (className) {
      createEle.className = className;
    }

    domBody.appendChild(createEle);
    return createEle;
  };

  Util.prototype.addScript = function (fileName, urlPath, callback) {
    var dom = document;
    var createScript = dom.createElement('script');
    var domHead = dom.getElementsByTagName('script');
    createScript.type = 'text/javascript';
    createScript.async = true;
    createScript.id = fileName;
    var sdkUrl = '';

    if (!urlPath) {
      if (dom.getElementById('ARK_SDK')) {
        sdkUrl = dom.getElementById('ARK_SDK').src;
      } else {
        for (var i = 0; i < domHead.length; i++) {
          if (domHead[i].src && domHead[i].src.indexOf('AnalysysAgent_JS_SDK') > -1) {
            sdkUrl = domHead[i].src;
            break;
          }
        }
      }
    } else {
      sdkUrl = urlPath.charAt(urlPath.length - 1) === '/' ? urlPath : urlPath + '/';
    }

    var sdkPath = sdkUrl.substring(0, sdkUrl.lastIndexOf('/') + 1);
    createScript.src = sdkPath + fileName + '.min.js?v=' + this.format(new Date(), 'yyyyMMddhhmm'); // 方舟B SDK地址

    createScript.onload = callback;
    domHead[0].parentNode.insertBefore(createScript, domHead[0]);
  }; // Util.prototype.unique = function (arr) {
  //     var a = {}
  //     for (var i = 0; i < arr.length; i++) {
  //         if (typeof a[arr[i]] == "undefined")
  //             a[arr[i]] = 1
  //     }
  //     arr.length = 0
  //     for (var i in a)
  //         arr[arr.length] = i
  //     return arr
  // }


  function CheckChinese(val) {
    var reg = new RegExp('[\\u4E00-\\u9FFF]+', 'g');

    if (reg.test(val)) {
      return true;
    }

    return false;
  }

  Util.prototype.GetUrlParam = function (paraName) {
    var url = document.location.toString();
    var arrObj = url.split('?');

    if (arrObj.length > 1) {
      var arrPara = []; // arrObj[1].split("&")

      for (var i = 1; i < arrObj.length; i++) {
        arrPara.push.apply(arrPara, arrObj[i].split('&'));
      }

      var arr;

      for (var index = 0; index < arrPara.length; index++) {
        arr = arrPara[index].split('=');

        if (arr != null && arr[0] === paraName) {
          var value = arr[1];

          if (arr[1].indexOf('#') > -1) {
            value = value.split('#')[0];
          }

          if (value.indexOf('%') > -1) {
            try {
              var utfValue = decodeURI(value);

              if (CheckChinese(utfValue)) {
                return utfValue;
              }
            } catch (e) {}

            if (this.paramType(window.AnalysysModule) === 'Object' && this.paramType(window.AnalysysModule.decodeGBK) === 'Function') {
              try {
                var gbkValue = window.AnalysysModule.decodeGBK(value, 'gbk');
                return gbkValue;
              } catch (e) {}
            }
          }

          return value;
        }
      }

      return '';
    } else {
      return '';
    }
  }; // Util.prototype.isInArray = function (arr, value) {
  //     for (var i = 0; i < arr.length; i++) {
  //         if (value === arr[i]) {
  //             return true
  //         }
  //     }
  //     return false
  // }


  Util.prototype.stringSlice = function (str, length) {
    return str.slice(0, length);
  };

  Util.prototype.trim = function (str) {
    if (this.paramType(str) === 'String') {
      return str.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, '');
    } else {
      return str;
    }
  };

  Util.prototype.changeHash = function (callback) {
    var historyPushState = window.history.pushState;
    var historyReplaceState = window.history.replaceState;

    window.history.pushState = function () {
      historyPushState.apply(window.history, arguments);
      callback.apply(callback);
    };

    window.history.replaceState = function () {
      historyReplaceState.apply(window.history, arguments);
      callback.apply(callback);
    };

    var state = historyPushState ? 'popstate' : 'hashchange';
    state = !!window.ActiveXObject || 'ActiveXObject' in window ? 'hashchange' : 'popstate';

    if ('on' + state in window) {
      this.addEvent(window, state, function () {
        setTimeout(callback, 0);
      });
    } // window.history.replaceState = this.addWindowEvent('pushState')
    // if ('onpopstate' in window) {
    //   if (!('onpushState' in window)) {
    //     window.history.pushState = this.addWindowEvent('pushState')
    //   }
    //   if (!('onreplaceState' in window)) {
    //     window.history.replaceState = this.addWindowEvent('replaceState')
    //   }
    //   this.addEvent(window, 'popstate', callback)
    //   this.addEvent(window, 'pushState', callback)
    //   this.addEvent(window, 'replaceState', callback)
    //   if (!!window.ActiveXObject || 'ActiveXObject' in window) {
    //     if ('onhashchange' in window) {
    //       this.addEvent(window, 'hashchange', callback)
    //     }
    //   }
    // } else if ('onhashchange' in window) {
    //   if (document.addEventListener) {
    //     this.addEvent(window, 'hashchange', callback)
    //   }
    // }

  };

  Util.prototype.deviceType = function () {
    var u = navigator.userAgent;

    if (u.indexOf('Tablet') > -1 && u.indexOf('PC') < 0 || u.indexOf('Pad') > -1 || u.indexOf('Nexus 7') > -1) {
      return 'tablet';
    }

    if (u.indexOf('Mobi') > -1 || u.indexOf('iPh') > -1 || u.indexOf('480') > -1) {
      return 'phone';
    }

    return 'desktop';
  };

  Util.prototype.checkTypeList = function (list, ele) {
    var listType = this.paramType(list);

    if (listType === 'String') {
      var url = window.location.href;
      var urlHost = window.location.protocol + '//' + window.location.host;
      var urlPath = urlHost + window.location.pathname;
      var urlIndex = urlPath + 'index.html';
      var urlHash = urlPath + window.location.hash;
      var urlArray = [url, urlHost, urlIndex, urlPath, urlHash];

      if (urlArray.indexOf(list) > -1) {
        return true;
      }
    } else if (listType === 'Function') {
      return list.call(list, ele);
    } else if (listType === 'Array') {
      for (var i = 0; i < list.length; i++) {
        if (this.checkTypeList(list[i], ele) === true) {
          return true;
        }
      }
    }

    return false;
  };
  /**
   * document.querySelectorAll 兼容方法
   * @param {Sting} selectors 选择器 不包含伪类
   * @returns {Array} elements 符合条件的元素列表
   */


  Util.prototype.selectorAllEleList = function (selectors) {
    var eleList = [];
    var eleTagName = selectors.split('.')[0];

    if (this.paramType(document.querySelectorAll) === 'Function' && selectors.indexOf('|') < 0) {
      try {
        return document.querySelectorAll(selectors);
      } catch (e) {// console.log(e.message)
      }
    }

    var eleId = '';

    if (selectors.indexOf('#') > -1) {
      eleId = selectors.split('.')[0].split('#')[1];
      var ele = document.getElementById(eleId);

      if (ele) {
        eleList.push(ele);
      }
    } else if (selectors.indexOf('.') < 0) {
      return document.getElementsByTagName(eleTagName);
    } else if (selectors.indexOf('[') > -1 && selectors.indexOf(']') > -1) {
      var nodeList = document.getElementsByTagName('*');
      var selector = selectors.replace('[', '').replace(']', '');

      for (var y = 0; y < nodeList.length; y++) {
        var attr = nodeList[y].getAttribute(selector);

        if (this.paramType(attr) === 'String') {
          eleList.push(ele);
        }
      }
    } else {
      var domList = document.getElementsByTagName(eleTagName);

      for (var i = 0; i < domList.length; i++) {
        var dom = domList[i];
        var domClassNameList = this.paramType(dom.className) === 'String' ? dom.className.split(' ') : [];

        if (domClassNameList.length > 0) {
          if ((eleTagName + '.' + domClassNameList.join('.')).indexOf(selectors) > -1) {
            eleList.push(dom);
          }
        }
      }
    } // var anchors = [];
    // for (var z = 0; z < eleList.length; z++) {
    //   anchors.push(eleList[z]);
    // }
    // anchors = anchors.sort(function (x, y) {
    //   return offset(x).left - offset(y).left && offset(x).top - offset(y).top
    // })
    // eleList = anchors


    return eleList;
  };

  var Util$1 = new Util();

  /**
   * SDK 基础字段定义表
   * base.outer：上报日志基础结构定义
   * base.xcontext:上报报文找中xcontext下的共有字段定义
   * $开头的字段为各个事件特殊拥有字段
   */
  var fieldTemplate = {
    base: {
      outer: ['appid', 'xwho', 'xwhat', 'xwhen', 'xcontext'],
      xcontext: ['$lib', '$lib_version', '$platform', '$debug', '$is_login']
    },
    $startup: {
      xcontext: ['$screen_width', '$screen_height', '$web_crawler', '$time_zone', '$language', '$session_id', '$is_first_time', '$is_first_day', '$utm_campaign_id', '$utm_source', '$utm_medium', '$utm_term', '$utm_content', '$utm_campaign', '$session_id', '$is_time_calibrated']
    },
    $track: {
      xcontext: ['$screen_width', '$screen_height', '$web_crawler', '$time_zone', '$language', '$is_first_day', '$session_id', '$utm_campaign_id', '$utm_source', '$utm_medium', '$utm_term', '$utm_content', '$utm_campaign', '$session_id', '$is_time_calibrated']
    },
    $pageview: {
      xcontext: ['$screen_width', '$screen_height', '$web_crawler', '$time_zone', '$language', '$session_id', '$is_first_day', '$referrer', '$referrer_domain', '$title', '$url', '$startup_time', '$utm_campaign_id', '$utm_source', '$utm_medium', '$utm_term', '$utm_content', '$utm_campaign', '$session_id', '$is_time_calibrated']
    },
    $alias: {
      xcontext: ['$original_id']
    },
    $getPresetProperties: {
      xcontext: ['$screen_width', '$screen_height', '$time_zone', '$session_id', '$language']
    }
  };

  var baseConfig = {
    base: {
      appid: '',
      $debug: 2,
      uploadURL: '',
      auto: true,
      autoProfile: true,
      hash: true,
      autoWebstay: true,
      singlePage: true,
      pageProperty: {},
      $lib_version: '4.4.1',
      cookieLevel: 2
    },
    status: {
      code: 200,
      FnName: '',
      key: '',
      value: '',
      errorCode: '',
      successCode: ''
    },
    keywords: fieldTemplate.base.xcontext,
    baseJson: fieldTemplate.base.outer,
    sendNum: 1800
  };

  /**
   * 存储模块。集中处理本地缓存内容
   * API：
   *  Local相关:永久存储数据相关操作
   *  session相关：临时存储数据相关操作
   *
   */

  function getDomainFromUrl() {
    var host = window.location.hostname;
    var level = baseConfig.base.cookieLevel ;

    if (Util$1.paramType(level) !== 'Number' || level < 2) {
      level = 2;
    }

    var ip = /^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;
    if (ip.test(host) === true || host === 'localhost') return '';
    var regex = /([^]*).*/;
    var match = host.match(regex);
    var urlDomain = [];
    if (typeof match !== 'undefined' && match !== null) host = match[1];

    if (typeof host !== 'undefined' && host !== null) {
      var strAry = host.split('.');

      if (strAry.length > 1) {
        if (strAry.length < level) {
          level = strAry.length;
        }

        for (var i = strAry.length - 1; i >= 0; i--) {
          if (urlDomain.length === level) {
            break;
          }

          urlDomain.push(strAry[i]);
        } // host = strAry[strAry.length - 2] + "." + strAry[strAry.length - 1];

      } else {
        return '';
      }
    }

    return '.' + urlDomain.reverse().join('.');
  }

  var Local = '';
  var Session = '';

  try {
    Local = typeof window.localStorage === 'object' ? window.localStorage : '';
    Session = typeof window.sessionStorage === 'object' ? window.sessionStorage : '';
  } catch (e) {}

  function Storage() {
    this.localName = 'FZ_STROAGE';
    this.sessionName = 'FZ_SESSION';
    this.localObj = this.getLocal();
    this.sessionObj = this.getSession();
  }

  Storage.prototype.setLocal = function (key, value) {
    this.localObj = this.getLocal();
    this.localObj[key] = value;

    try {
      if (!Local) {
        if (key !== 'POSTDATA') {
          this.setCookie(this.localName, encodeURIComponent(Util$1.encode(JSON.stringify(this.localObj))));
        }
      } else {
        Local.setItem(this.localName, Util$1.encode(JSON.stringify(this.localObj)));
        Session.setItem(this.localName, Util$1.encode(JSON.stringify(this.localObj)));
        this.removeCookie(this.localName);
      }
    } catch (e) {}
  };

  Storage.prototype.getLocal = function (key) {
    try {
      var localData = {};

      if (!Local) {
        localData = this.getCookie(this.localName);

        if (localData) {
          localData = decodeURIComponent(localData);
        } else {
          localData = Util$1.encode('{}');
        }
      } else {
        localData = Local.getItem(this.localName);

        if (!localData) {
          var sessionLocal = Session.getItem(this.localName);

          if (sessionLocal) {
            localData = Session.getItem(this.localName);
            Local.setItem(this.localName, localData);
          } else {
            localData = Util$1.encode('{}');
          }
        }

        this.removeCookie(this.localName);
      }

      this.localObj = JSON.parse(Util$1.decode(localData));

      if (!key) {
        return this.localObj;
      }

      return this.localObj[key];
    } catch (e) {
      if (!key) {
        return {};
      } else {
        return '';
      }
    }
  };

  Storage.prototype.removeLocal = function (key) {
    this.localObj = this.getLocal();

    if (Util$1.objHasKay(this.localObj, key)) {
      delete this.localObj[key];
    }

    if (Util$1.isEmptyObject(this.localObj)) {
      try {
        if (!Local) {
          this.removeCookie(this.localName);
        } else {
          Local.removeItem(this.localName);
          Session.removeItem(this.localName);
          this.removeCookie(this.localName);
        }
      } catch (e) {}
    } else {
      if (!Local) {
        if (key !== 'POSTDATA' && key !== 'ARK_ID') {
          this.setCookie(this.localName, Util$1.encode(JSON.stringify(this.localObj)));
        }
      } else {
        Local.setItem(this.localName, Util$1.encode(JSON.stringify(this.localObj)));
        Session.setItem(this.localName, Util$1.encode(JSON.stringify(this.localObj)));
        this.removeCookie(this.localName);
      }
    }
  };

  Storage.prototype.setSession = function (key, value) {
    this.sessionObj = this.getSession();
    this.sessionObj[key] = value;

    try {
      if (!Session) {
        if (key !== 'POSTDATA') {
          this.setCookie(this.sessionName, Util$1.encode(JSON.stringify(this.sessionObj)), 'session');
        }
      } else {
        Session.setItem(this.sessionName, Util$1.encode(JSON.stringify(this.sessionObj)));
        this.removeCookie(this.sessionName);
      }
    } catch (e) {}
  };

  Storage.prototype.getSession = function (key) {
    try {
      var sessionData = {};

      if (!Session) {
        sessionData = this.getCookie(this.sessionName) || Util$1.encode('{}');
      } else {
        sessionData = Session.getItem(this.sessionName) || Util$1.encode('{}');
        this.removeCookie(this.sessionName);
      }

      this.sessionObj = JSON.parse(Util$1.decode(sessionData));

      if (!key) {
        return this.sessionObj;
      }

      return this.sessionObj[key];
    } catch (e) {
      return {};
    }
  };

  Storage.prototype.removeSession = function (key) {
    this.sessionObj = this.getSession();

    if (Util$1.objHasKay(this.sessionObj, key)) {
      delete this.sessionObj[key];
    }

    if (Util$1.isEmptyObject(this.sessionObj)) {
      try {
        if (!Local) {
          this.removeCookie(this.sessionName);
        } else {
          Session.removeItem(this.sessionName);
          this.removeCookie(this.sessionName);
        }
      } catch (e) {}
    } else {
      if (!Session) {
        if (key !== 'POSTDATA' && key !== 'ARK_ID') {
          this.setCookie(this.sessionName, Util$1.encode(JSON.stringify(this.sessionObj)), 'session');
        }
      } else {
        Session.setItem(this.sessionName, Util$1.encode(JSON.stringify(this.sessionObj)));
        this.removeCookie(this.sessionName);
      }
    }
  };

  Storage.prototype.setCookie = function (name, value, type) {
    var urlDomain = getDomainFromUrl();
    var path = '; path=/';
    var domain = !urlDomain ? '' : '; domain=' + urlDomain;
    var time = '';

    if (type !== 'session') {
      var date = new Date();
      date.setTime(date.getTime() + 1 * 365 * 24 * 60 * 60 * 1000);
      time = '; expires=' + date.toGMTString();
    }

    document.cookie = name + '=' + value + time + path + domain;
  };

  Storage.prototype.getCookie = function (name) {
    var text = document.cookie;

    if (typeof text !== 'string') {
      return '';
    }

    var nameEQ = name + '=';
    var ca = text.split(/[;&]/);
    var i;
    var c;

    for (i = 0; i < ca.length; i++) {
      c = ca[i];

      while (c.charAt(0) === ' ') {
        c = c.substring(1, c.length);
      }

      if (c.indexOf(nameEQ) === 0) {
        return c.substring(nameEQ.length, c.length);
      }
    }
  };

  Storage.prototype.removeCookie = function (name) {
    var urlDomain = getDomainFromUrl();
    var path = '; path=/';
    var domain = urlDomain ? '' : '; domain=.' + urlDomain;
    var date = new Date();
    date.setTime(date.getTime() - 1000);
    var time = date.toGMTString();
    document.cookie = name + '=; expires=' + time + path + domain;
  };

  var Storage$1 = new Storage();

  var heatmapConfig = window.ARK_HEATMAP && window.ARK_HEATMAP.config;
  var ifarmeMessageList = [];
  var showMapConfig = {
    type: 'heatmap',
    content: {},
    control: {},
    contentText: {},
    isRefresh: false,
    max: 10,
    rightMaxNum: 100
  };

  function backParam() {
    var params = {
      content: showMapConfig.content,
      times: +new Date() + (Storage$1.getLocal('ANSSERVERTIME') ? Number(Storage$1.getLocal('ANSSERVERTIME')) : 0)
    };
    params.content.requestType = 'web';
    params.content.appKey = heatmapConfig.appid;

    if (!params.content.deviceType) {
      params.content.deviceType = Util$1.deviceType();
    }

    if (showMapConfig.isRefresh === true) {
      params.content.useCache = false;
    } else {
      params.content.useCache = true;
    } // if (!params.content["dbUrlDomain"]) {
    // var urlPath = params.content["urlDomain"] || params.content["urlPath"]
    // if (!urlPath) {
    //     urlPath = location.protocol + '//' + location.host + location.pathname + location.hash
    //     urlPath = urlPath.split('?')[0]
    // }
    // // urlPath = urlPath.split('#')[0]
    // params.content["urlDomain"] = params.content["urlPath"] = urlPath
    // }


    showMapConfig.isRefresh = false;
    params.content = JSON.stringify(params.content);
    var param = [];

    for (var key in params) {
      param.push(key + '=' + encodeURIComponent(params[key]));
    }

    param = param.join('&');
    return param;
  }

  /**
   * [sendMsg description]发送热图SDK初始化完毕信息
   * @return {[type]} [description]
   */

  function sendMsg() {
    var msg = JSON.stringify({
      code: 'ark/heatmap',
      appkey: heatmapConfig.appid
    });
    console.log('发送热图SDK初始化完毕消息===>', msg);
    window.parent.postMessage(msg, '*');
  }
  /**
   * [getMsg description]接收iframe消息
   * @param  {Function} callback [description]
   * @return {[type]}            [description]
   */


  function getMsg(callback) {
    Util$1.addEvent(window, 'message', function (msgObj) {
      var msg = msgObj.data;
      console.log('获取服务端热图命令===>', JSON.stringify(msgObj.data));

      try {
        if (Util$1.paramType(msg) === 'String') {
          msg = JSON.parse(msg);
        }
      } catch (e) {}

      callback(msg);
    });
  }

  function getElementContent(ele) {
    var eleContent = '';

    if (ele.tagName.toLowerCase() === 'input' && (ele.type === 'button' || ele.type === 'submit')) {
      eleContent = Util$1.trim(ele.value) || '';
    } else if (ele.tagName.toLowerCase() === 'img') {
      eleContent = Util$1.trim(ele.getAttribute('alt')) || Util$1.trim(ele.getAttribute('title')) || '';
    } else if (ele.tagName.toLowerCase() === 'a') {
      eleContent = Util$1.trim(ele.getAttribute('title')) || '';
    }

    if (!eleContent) {
      if (ele.textContent) {
        eleContent = Util$1.trim(ele.textContent);
      } else {
        if (ele.innerText) {
          eleContent = Util$1.trim(ele.innerText);
        }
      }
    }

    if (eleContent && Util$1.paramType(eleContent) === 'String') {
      eleContent = eleContent.replace(/[\r\n]/g, ' ').replace(/[ ]+/g, ' ').substring(0, 255);
    } else {
      eleContent = '';
    }

    if (ele.tagName.toLowerCase() === 'input') {
      return '';
    }

    return eleContent;
  }

  function domParentList(ele) {
    var list = [];
    var parent = ele;

    while (parent != null) {
      var index = 0;

      if (parent.parentNode) {
        var clildrenEles = parent.parentNode.children;

        if (clildrenEles) {
          for (var i = 0; i < clildrenEles.length; i++) {
            if (clildrenEles[i] === parent) {
              index = i;
            }
          }
        }
      }

      var tagName = parent.tagName;

      if (!tagName) {
        parent = parent.parentNode;
        continue;
      }

      tagName = tagName.toLowerCase();
      var parentID = parent.id ? '#' + parent.id : '';
      var eleClassNameList = parent.className && Util$1.paramType(parent.className) === 'String' ? parent.className.split(' ') : [];

      if (eleClassNameList.length > 0) {
        var eleClassName = '';

        for (var y = 0; y < eleClassNameList.length; y++) {
          if (eleClassNameList[y] && eleClassNameList[y].indexOf('ARK') < 0) {
            eleClassName += '.' + eleClassNameList[y];
          }
        }

        list.push(tagName + parentID + eleClassName + '|' + index);
      } else {
        list.push(tagName + parentID + '|' + index);
      }

      parent = parent.parentNode;
    }

    return list.join('<');
  }

  var rootNodeRE = /^(?:body|html)$/i;

  function pathContrast(eventPath, elePath) {
    eventPath = eventPath.split('<body')[0];
    elePath = elePath.split('<body')[0];
    var eventPathArray = eventPath.split('<');
    var elePathArray = elePath.split('<');

    if (eventPathArray[0] === elePathArray[0]) {
      for (var i = 1; i < eventPathArray.length; i++) {
        if (eventPathArray[i].indexOf('|') > -1 && elePathArray[i].indexOf('|') > -1) {
          var eventPathIndex = eventPathArray[i].split('|')[1];
          var elePathIndex = elePathArray[i].split('|')[1];

          if (eventPathIndex !== elePathIndex) {
            return false;
          }
        }

        if (eventPathArray[i].split('.')[0] !== elePathArray[i].split('.')[0]) {
          return false;
        }
      }

      return true;
    }

    return false;
  }

  function parseEvent(path) {
    var eleObj = parserDom(path);

    if (eleObj.length === 0) {
      return;
    }

    var baseEle = eleObj[0].elePath;

    try {
      if (baseEle.indexOf('#') > -1) {
        baseEle = '#' + baseEle.split('#')[1];
      }

      var eleList = Util$1.selectorAllEleList(baseEle); // document.querySelectorAll(baseEle)

      for (var i = 0; i < eleList.length; i++) {
        var ele = eleList[i];

        if (rootNodeRE.test(ele.nodeName)) {
          return document.body;
        }

        var elePath = domParentList(ele);
        var eleIndex = parserDom(elePath).index;

        if (elePath === path || pathContrast(elePath, path) === true && eleObj.index === eleIndex) {
          return eleList[i];
        }
      }
    } catch (e) {}

    return null;
  }
  /**
   * [parserDom description]
   * @param  {[type]} path [description]
   * @return {[type]}      [description]
   */


  function parserDom(path) {
    var eleList = [];

    if (path.indexOf('<') < 0) {
      return [{
        elePath: path.split('|')[0],
        index: path.split('|')[1]
      }];
    }

    var pathObj = path.split('<');

    for (var i = 0; i < pathObj.length; i++) {
      var elelPath = pathObj[i].split('|')[0];
      var eleIndex = pathObj[i].split('|')[1];
      eleList.push({
        elePath: elelPath,
        index: eleIndex
      });
    }

    return eleList;
  }

  var camelize = function (str) {
    return str.replace(/-+(.)?/g, function (match, chr) {
      if (chr) {
        return chr.toUpperCase();
      } else {
        return '';
      }
    });
  };
  /**
   * [eleCss description]根据元素对应css列表获取对应属性
   * @param  {[type]} element  [description]元素dom
   * @param  {[type]} property [description]css名称
   * @return {[type]} value [description]css名称对应值
   */


  function eleCss(element, property) {
    var computedStyle, len1, prop, props, q;

    if (!element) {
      return;
    }

    computedStyle = window.getComputedStyle(element, '');

    if (typeof property === 'string') {
      return element.style[camelize(property)] || computedStyle.getPropertyValue(property);
    } else if (Array.isArray(property)) {
      props = {};

      for (q = 0, len1 = property.length; q < len1; q++) {
        prop = property[q];
        props[prop] = element.style[camelize(prop)] || computedStyle.getPropertyValue(prop);
      }

      return props;
    }
  }
  /**
   * [parserDom description]根据元素及其上层元素获取元素位置及显示/隐藏
   * @param  {[type]} ele [description] 元素Dom对象
   * @return {[type]} obj [description] 元素对应位置与显示/隐藏
   */


  function eleOffset(ele) {
    var realTop = 0;
    var realLeft = 0;
    var elemHidden = false;
    var isFixed = false;

    while (ele != null) {
      realTop += ele.offsetTop;
      realLeft += ele.offsetLeft;

      if (!elemHidden) {
        elemHidden = !!(eleCss(ele, 'display') === 'none' || eleCss(ele, 'width') === '0px' || eleCss(ele, 'height') === '0px');
      }

      if (eleCss(ele, 'position') === 'fixed') {
        isFixed = true;
      }

      ele = ele.offsetParent;
    }

    if (isFixed === true) {
      realTop += document.documentElement.scrollTop || document.body.scrollTop;
      realLeft += document.documentElement.scrollLeft || document.body.scrollLeft;
    }

    return {
      top: realTop,
      left: realLeft,
      hidden: elemHidden
    };
  }
  /**
   * [offsetParent description] 获取父元素
   * @return {[type]} [description]
   */
  // function eleOffsetParent (elem) {
  //   var parent
  //   while (elem && !elem.offsetParent) {
  //     elem = elem.parentNode
  //     if (elem === document.body) {
  //       break
  //     }
  //   }
  //   if (!elem) return document.body
  //   parent = elem.offsetParent || document.body
  //   while (parent && !rootNodeRE.test(parent.nodeName) && eleCss(parent, 'position') === 'static') {
  //     parent = parent.offsetParent
  //   }
  //   return parent
  // }

  /**
   * [elementPostion description] 返回标签元素坐标及是否隐藏
   * @param  {[type]} elem [description]标签元素
   * @return {[type]}     [description]x-横坐标 number y-纵坐标 number hidden-是否隐藏隐藏 Bloon
   */


  function elementPostion(elem) {
    var position = {
      top: 0,
      left: 0,
      hidden: true
    };

    if (!elem) {
      return position;
    }

    var elePosition = eleOffset(elem);

    if (!elePosition) {
      return position;
    }

    position = {
      top: elePosition.top,
      left: elePosition.left,
      hidden: elePosition.hidden
    };

    if (!position) {
      return {
        top: 0,
        left: 0,
        hidden: true
      };
    }

    return position;
  }
  /**
   * [isEmbedded description] 判断是否为嵌入式
   * @return {Boolean} [description] true - 嵌入式 false - 交互式
   */


  function isEmbedded(key) {
    var urlParam = pipParam(pipParam(Util$1.GetUrlParam(key), '/'), '#');

    if (window.top !== window.self && urlParam === 'true') {
      return true;
    }

    return false;
  }
  /**
   * [isElmentReady description] 页面dom是否渲染成功
   * 仅判断dom列表是否渲染完毕，不保证img加载完毕
   * img加载完触发window.resize进行兼容
   * @return {Boolean} [description]
   */


  function isElmentReady() {
    if (document && document.documentElement && document.getElementsByTagName && document.getElementById && document.body && document.documentElement.scrollWidth !== 0) {
      return true;
    } else {
      return false;
    }
  }
  /**
   * [isParent description] 判断是当前元素否为指定元素的子元素
   * @param  {[type]}  ele       [description] 当前元素
   * @param  {[type]}  parentEle [description] 指定元素
   * @return {Boolean}           [description]
   */


  function isParent(ele, parentEle) {
    // 任何元素都为BODY的子元素
    while (ele && ele.tagName.toUpperCase() !== 'BODY' && ele.tagName.toUpperCase() !== 'HTML') {
      if (Util$1.paramType(parentEle) === 'Array') {
        for (var i = 0; i < parentEle.length; i++) {
          if (ele === parentEle[i]) {
            return true;
          }
        }
      } else {
        if (ele === parentEle) {
          return true;
        }
      }

      ele = ele.parentNode;
    }

    return false;
  }
  /**
   * [getConstantStyle description] 返回元素对应的样式值
   * @param  {[type]} el     [description] 元素
   * @param  {[type]} pelStr [description] 样式名称
   * @return {[type]}        [description]
   */


  function getConstantStyle(el, pelStr) {
    var w = document.defaultView;

    if (w && w.getComputedStyle) {
      return document.defaultView.getComputedStyle(el, null)[pelStr];
    } else {
      return el.currentStyle[pelStr];
    }
  }
  /**
   * [pipParam description] 去除字符串后面最后一位
   * @param  {[type]} param [description]
   * @return {[type]}       [description]
   */


  function pipParam(param, str) {
    if (param.charAt(param.length - 1) === str) {
      param = param.substr(0, param.length - 1);
    }

    if (param.charAt(param.length - 1) === str) {
      param = param.substr(0, param.length - 1);
    }

    return param;
  }

  function getJSON(data) {
    if (Util$1.paramType(data) === 'String') {
      if (data.indexOf('\n') > -1) {
        data = data.replace(/[\r\n]/g, '');
      }

      try {
        return JSON.parse(data);
      } catch (e) {}

      try {
        return window.AnalysysModule.zipInflate(data);
      } catch (e) {}

      if (data === 'H4sIAAAAAAAAAKtWSs5PSVWyMjIwqAUAVAOW6gwAAAA=') {
        return {
          code: 200
        };
      } else if (data === 'H4sIAAAAAAAAAKtWSs5PSVWyMjUwqAUA7TtBdwwAAAA=') {
        return {
          code: 500
        };
      } else if (data === 'H4sIAAAAAAAAAKtWSs5PSVWyMjEy0FHKLU5XslJySSxJVHBJTS6qLChRcC0qyi/S01OqBQBdATGSKQAAAA==') {
        return {
          code: 420
        };
      } else {
        return {
          code: 200
        };
      }
    } else if (Util$1.paramType(data) === 'Object') {
      return data;
    } else {
      return {
        code: 200
      };
    }
  }

  function GetHttpObj() {
    var httpobj = null;

    if (window.XDomainRequest) {
      return new window.XDomainRequest();
    }

    if (window.XMLHttpRequest) {
      httpobj = new window.XMLHttpRequest();
    } else {
      try {
        httpobj = new window.ActiveXObject('Microsoft.XMLHTTP');
      } catch (e) {
        try {
          httpobj = new window.ActiveXObject('Msxml2.XMLHTTP');
        } catch (e1) {
          httpobj = new window.XMLHttpRequest();
        }
      }
    }

    return httpobj;
  }

  function xmlhttp(_this) {
    var sendStatus = false;
    var xhr = new GetHttpObj(); // xhr.setRequestHeader("reqt",+new Date())
    // xhr.setRequestHeader("reqv",1)

    xhr.onload = function () {
      if (sendStatus) return;
      sendStatus = true;

      _this.success(getJSON(xhr.responseText), xhr);
    };

    xhr.onerror = function () {
      if (sendStatus) return;
      sendStatus = true;

      _this.error(getJSON(xhr.responseText), xhr);
    };

    xhr.onreadystatechange = function () {
      if (xhr.readyState === 4) {
        try {
          if (xhr.getAllResponseHeaders().indexOf('Date') > -1 || xhr.getAllResponseHeaders().indexOf('date') > -1) {
            var time = +new Date();
            var date = xhr.getResponseHeader('Date') || xhr.getResponseHeader('date');

            if (date) {
              Storage$1.setLocal('ANSSERVERTIME', +new Date(date) - time);
            }
          }
        } catch (e) {}

        if (xhr.status >= 200 && xhr.status < 300 || xhr.status === 304) {
          if (sendStatus) return;
          sendStatus = true;

          _this.success(getJSON(xhr.responseText), xhr);
        } else {
          if (sendStatus) return;
          sendStatus = true;

          _this.error();
        }

        xhr.onreadystatechange = null;
        xhr.onload = null;
      }
    };

    try {
      xhr.open(_this.type, _this.url, true); // xhr.setRequestHeader("Content-Type","multipart/form-data")

      xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');

      if (_this.type === 'GET') {
        xhr.send(null);
      } else {
        xhr.send(_this.data);
      }
    } catch (e) {}
  } // function lengthBaty(str) {
  //     var bytesCount = 0
  //     for (var i = 0; i < str.length; i++) {
  //         var c = str.charAt(i)
  //         if (/^[\u0000-\u00ff]$/.test(c)) //匹配双字节
  //         {
  //             bytesCount += 1
  //         } else {
  //             bytesCount += 2
  //         }
  //     }
  //     return bytesCount
  // }


  function ajax() {
    this.url = '';
    this.data = '';
    this.type = 'GET';

    this.success = function () {};

    this.error = function () {};
  }

  ajax.prototype.get = function (option) {
    var param = [];

    for (var key in option.data) {
      param.push(key + '=' + encodeURIComponent(option.data[key]));
    }

    var url = option.url.indexOf('?') > -1 ? option.url + '&' + param.join('&') : option.url + '?' + param.join('&');
    this.url = url;
    this.data = option.data;
    this.type = 'GET';

    this.success = option.success || function () {};

    this.error = option.error || function () {};

    xmlhttp(this);
  };

  ajax.prototype.post = function (option) {
    this.url = option.url;
    this.data = option.data;
    this.type = 'POST';

    this.success = option.success || function () {};

    this.error = option.error || function () {};

    xmlhttp(this);
  };

  var commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};

  function createCommonjsModule(fn, module) {
  	return module = { exports: {} }, fn(module, module.exports), module.exports;
  }

  var heatmap = createCommonjsModule(function (module) {

    (function (name, context, factory) {
      // Supports UMD. AMD, CommonJS/Node.js and browser context
      if ( module.exports) {
        module.exports = factory();
      } else {
        context[name] = factory();
      }
    })('h337', commonjsGlobal, function () {
      // Heatmap Config stores default values and will be merged with instance config
      var HeatmapConfig = {
        defaultRadius: 40,
        defaultRenderer: 'canvas2d',
        defaultGradient: {
          0.25: 'rgb(0,0,255)',
          0.55: 'rgb(0,255,0)',
          0.85: 'yellow',
          1.0: 'rgb(255,0,0)'
        },
        defaultMaxOpacity: 1,
        defaultMinOpacity: 0,
        defaultBlur: 0.85,
        defaultXField: 'x',
        defaultYField: 'y',
        defaultValueField: 'value',
        plugins: {}
      };

      var Store = function StoreClosure() {
        var Store = function Store(config) {
          this._coordinator = {};
          this._data = [];
          this._radi = [];
          this._min = 10;
          this._max = 1;
          this._xField = config.xField || config.defaultXField;
          this._yField = config.yField || config.defaultYField;
          this._valueField = config.valueField || config.defaultValueField;

          if (config.radius) {
            this._cfgRadius = config.radius;
          }
        };

        var defaultRadius = HeatmapConfig.defaultRadius;
        Store.prototype = {
          // when forceRender = false -> called from setData, omits renderall event
          _organiseData: function (dataPoint, forceRender) {
            var x = dataPoint[this._xField];
            var y = dataPoint[this._yField];
            var radi = this._radi;
            var store = this._data;
            var max = this._max;
            var min = this._min;
            var value = dataPoint[this._valueField] || 1;
            var radius = dataPoint.radius || this._cfgRadius || defaultRadius;

            if (!store[x]) {
              store[x] = [];
              radi[x] = [];
            }

            if (!store[x][y]) {
              store[x][y] = value;
              radi[x][y] = radius;
            } else {
              store[x][y] += value;
            }

            var storedVal = store[x][y];

            if (storedVal > max) {
              if (!forceRender) {
                this._max = storedVal;
              } else {
                this.setDataMax(storedVal);
              }

              return false;
            } else if (storedVal < min) {
              if (!forceRender) {
                this._min = storedVal;
              } else {
                this.setDataMin(storedVal);
              }

              return false;
            } else {
              return {
                x: x,
                y: y,
                value: value,
                radius: radius,
                min: min,
                max: max
              };
            }
          },
          _unOrganizeData: function () {
            var unorganizedData = [];
            var data = this._data;
            var radi = this._radi;

            for (var x in data) {
              for (var y in data[x]) {
                unorganizedData.push({
                  x: x,
                  y: y,
                  radius: radi[x][y],
                  value: data[x][y]
                });
              }
            }

            return {
              min: this._min,
              max: this._max,
              data: unorganizedData
            };
          },
          _onExtremaChange: function () {
            this._coordinator.emit('extremachange', {
              min: this._min,
              max: this._max
            });
          },
          addData: function () {
            if (arguments[0].length > 0) {
              var dataArr = arguments[0];
              var dataLen = dataArr.length;

              while (dataLen--) {
                this.addData.call(this, dataArr[dataLen]);
              }
            } else {
              // add to store
              var organisedEntry = this._organiseData(arguments[0], true);

              if (organisedEntry) {
                // if it's the first datapoint initialize the extremas with it
                if (this._data.length === 0) {
                  this._min = this._max = organisedEntry.value;
                }

                this._coordinator.emit('renderpartial', {
                  min: this._min,
                  max: this._max,
                  data: [organisedEntry]
                });
              }
            }

            return this;
          },
          setData: function (data) {
            var dataPoints = data.data;
            var pointsLen = dataPoints.length; // reset data arrays

            this._data = [];
            this._radi = [];

            for (var i = 0; i < pointsLen; i++) {
              this._organiseData(dataPoints[i], false);
            }

            this._max = data.max;
            this._min = data.min || 0;

            this._onExtremaChange();

            this._coordinator.emit('renderall', this._getInternalData());

            return this;
          },
          removeData: function () {// TODO: implement
          },
          setDataMax: function (max) {
            this._max = max;

            this._onExtremaChange();

            this._coordinator.emit('renderall', this._getInternalData());

            return this;
          },
          setDataMin: function (min) {
            this._min = min;

            this._onExtremaChange();

            this._coordinator.emit('renderall', this._getInternalData());

            return this;
          },
          setCoordinator: function (coordinator) {
            this._coordinator = coordinator;
          },
          _getInternalData: function () {
            return {
              max: this._max,
              min: this._min,
              data: this._data,
              radi: this._radi
            };
          },
          getData: function () {
            return this._unOrganizeData();
          }
          /*,
          TODO: rethink.
          getValueAt: function(point) {
          var value;
          var radius = 100;
          var x = point.x;
          var y = point.y;
          var data = this._data;
          if (data[x] && data[x][y]) {
           return data[x][y];
          } else {
           var values = [];
           // radial search for datapoints based on default radius
           for(var distance = 1; distance < radius; distance++) {
             var neighbors = distance * 2 +1;
             var startX = x - distance;
             var startY = y - distance;
              for(var i = 0; i < neighbors; i++) {
               for (var o = 0; o < neighbors; o++) {
                 if ((i == 0 || i == neighbors-1) || (o == 0 || o == neighbors-1)) {
                   if (data[startY+i] && data[startY+i][startX+o]) {
                     values.push(data[startY+i][startX+o]);
                   }
                 } else {
                   continue;
                 }
               }
             }
           }
           if (values.length > 0) {
             return Math.max.apply(Math, values);
           }
          }
          return false;
          } */

        };
        return Store;
      }();

      var Canvas2dRenderer = function Canvas2dRendererClosure() {
        var _getColorPalette = function (config) {
          var gradientConfig = config.gradient || config.defaultGradient;
          var paletteCanvas = document.createElement('canvas');
          var paletteCtx = paletteCanvas.getContext('2d');
          paletteCanvas.width = 256;
          paletteCanvas.height = 1;
          var gradient = paletteCtx.createLinearGradient(0, 0, 256, 1);

          for (var key in gradientConfig) {
            gradient.addColorStop(key, gradientConfig[key]);
          }

          paletteCtx.fillStyle = gradient;
          paletteCtx.fillRect(0, 0, 256, 1);
          return paletteCtx.getImageData(0, 0, 256, 1).data;
        };

        var _getPointTemplate = function (radius, blurFactor) {
          var tplCanvas = document.createElement('canvas');
          var tplCtx = tplCanvas.getContext('2d');
          var x = radius;
          var y = radius;
          tplCanvas.width = tplCanvas.height = radius * 2;

          if (blurFactor == 1) {
            tplCtx.beginPath();
            tplCtx.arc(x, y, radius, 0, 2 * Math.PI, false);
            tplCtx.fillStyle = 'rgba(0,0,0,1)';
            tplCtx.fill();
          } else {
            var gradient = tplCtx.createRadialGradient(x, y, radius * blurFactor, x, y, radius);
            gradient.addColorStop(0, 'rgba(0,0,0,1)');
            gradient.addColorStop(1, 'rgba(0,0,0,0)');
            tplCtx.fillStyle = gradient;
            tplCtx.fillRect(0, 0, 2 * radius, 2 * radius);
          }

          return tplCanvas;
        };

        var _prepareData = function (data) {
          var renderData = [];
          var min = data.min;
          var max = data.max;
          var radi = data.radi;
          var data = data.data;
          var xValues = Object.keys(data);
          var xValuesLen = xValues.length;

          while (xValuesLen--) {
            var xValue = xValues[xValuesLen];
            var yValues = Object.keys(data[xValue]);
            var yValuesLen = yValues.length;

            while (yValuesLen--) {
              var yValue = yValues[yValuesLen];
              var value = data[xValue][yValue];
              var radius = radi[xValue][yValue];
              renderData.push({
                x: xValue,
                y: yValue,
                value: value,
                radius: radius
              });
            }
          }

          return {
            min: min,
            max: max,
            data: renderData
          };
        };

        function Canvas2dRenderer(config) {
          var container = config.container;
          var shadowCanvas = this.shadowCanvas = document.createElement('canvas');
          var canvas = this.canvas = config.canvas || document.createElement('canvas');
          var renderBoundaries = this._renderBoundaries = [10000, 10000, 0, 0];
          var computed = getComputedStyle(config.container) || {};
          canvas.className = 'heatmap-canvas';
          this._width = canvas.width = shadowCanvas.width = config.width || +computed.width.replace(/px/, '');
          this._height = canvas.height = shadowCanvas.height = config.height || +computed.height.replace(/px/, '');
          this.shadowCtx = shadowCanvas.getContext('2d');
          this.ctx = canvas.getContext('2d'); // @TODO:
          // conditional wrapper

          canvas.style.cssText = shadowCanvas.style.cssText = 'position:absolute;left:0;top:0;';
          container.style.position = 'relative';
          container.appendChild(canvas);
          this._palette = _getColorPalette(config);
          this._templates = {};

          this._setStyles(config);
        }
        Canvas2dRenderer.prototype = {
          renderPartial: function (data) {
            if (data.data.length > 0) {
              this._drawAlpha(data);

              this._colorize();
            }
          },
          renderAll: function (data) {
            // reset render boundaries
            this._clear();

            if (data.data.length > 0) {
              this._drawAlpha(_prepareData(data));

              this._colorize();
            }
          },
          _updateGradient: function (config) {
            this._palette = _getColorPalette(config);
          },
          updateConfig: function (config) {
            if (config.gradient) {
              this._updateGradient(config);
            }

            this._setStyles(config);
          },
          setDimensions: function (width, height) {
            this._width = width;
            this._height = height;
            this.canvas.width = this.shadowCanvas.width = width;
            this.canvas.height = this.shadowCanvas.height = height;
          },
          _clear: function () {
            this.shadowCtx.clearRect(0, 0, this._width, this._height);
            this.ctx.clearRect(0, 0, this._width, this._height);
          },
          _setStyles: function (config) {
            this._blur = config.blur == 0 ? 0 : config.blur || config.defaultBlur;

            if (config.backgroundColor) {
              this.canvas.style.backgroundColor = config.backgroundColor;
            }

            this._width = this.canvas.width = this.shadowCanvas.width = config.width || this._width;
            this._height = this.canvas.height = this.shadowCanvas.height = config.height || this._height;
            this._opacity = (config.opacity || 0) * 255;
            this._maxOpacity = (config.maxOpacity || config.defaultMaxOpacity) * 255;
            this._minOpacity = (config.minOpacity || config.defaultMinOpacity) * 255;
            this._useGradientOpacity = !!config.useGradientOpacity;
          },
          _drawAlpha: function (data) {
            var min = this._min = data.min;
            var max = this._max = data.max;
            var data = data.data || [];
            var dataLen = data.length; // on a point basis?

            var blur = 1 - this._blur;

            while (dataLen--) {
              var point = data[dataLen];
              var x = point.x;
              var y = point.y;
              var radius = point.radius; // if value is bigger than max
              // use max as value

              var value = Math.min(point.value, max);
              var rectX = x - radius;
              var rectY = y - radius;
              var shadowCtx = this.shadowCtx;
              var tpl;

              if (!this._templates[radius]) {
                this._templates[radius] = tpl = _getPointTemplate(radius, blur);
              } else {
                tpl = this._templates[radius];
              } // value from minimum / value range
              // => [0, 1]


              var templateAlpha = (value - min) / (max - min); // this fixes #176: small values are not visible because globalAlpha < .01 cannot be read from imageData

              shadowCtx.globalAlpha = templateAlpha < 0.01 ? 0.01 : templateAlpha;
              shadowCtx.drawImage(tpl, rectX, rectY); // update renderBoundaries

              if (rectX < this._renderBoundaries[0]) {
                this._renderBoundaries[0] = rectX;
              }

              if (rectY < this._renderBoundaries[1]) {
                this._renderBoundaries[1] = rectY;
              }

              if (rectX + 2 * radius > this._renderBoundaries[2]) {
                this._renderBoundaries[2] = rectX + 2 * radius;
              }

              if (rectY + 2 * radius > this._renderBoundaries[3]) {
                this._renderBoundaries[3] = rectY + 2 * radius;
              }
            }
          },
          _colorize: function () {
            var x = this._renderBoundaries[0];
            var y = this._renderBoundaries[1];
            var width = this._renderBoundaries[2] - x;
            var height = this._renderBoundaries[3] - y;
            var maxWidth = this._width;
            var maxHeight = this._height;
            var opacity = this._opacity;
            var maxOpacity = this._maxOpacity;
            var minOpacity = this._minOpacity;
            var useGradientOpacity = this._useGradientOpacity;

            if (x < 0) {
              x = 0;
            }

            if (y < 0) {
              y = 0;
            }

            if (x + width > maxWidth) {
              width = maxWidth - x;
            }

            if (y + height > maxHeight) {
              height = maxHeight - y;
            }

            var img = this.shadowCtx.getImageData(x, y, width, height);
            var imgData = img;
            var len = imgData.data.length;
            var palette = this._palette;

            for (var i = 3; i < len; i += 4) {
              var alpha = imgData.data[i];
              var offset = alpha * 4;

              if (!offset) {
                continue;
              }

              var finalAlpha;

              if (opacity > 0) {
                finalAlpha = opacity;
              } else {
                if (alpha < maxOpacity) {
                  if (alpha < minOpacity) {
                    finalAlpha = minOpacity;
                  } else {
                    finalAlpha = alpha;
                  }
                } else {
                  finalAlpha = maxOpacity;
                }
              }

              imgData.data[i - 3] = palette[offset];
              imgData.data[i - 2] = palette[offset + 1];
              imgData.data[i - 1] = palette[offset + 2];
              imgData.data[i] = useGradientOpacity ? palette[offset + 3] : finalAlpha;
            } // img.data = imgData;


            this.ctx.putImageData(imgData, x, y);
            this._renderBoundaries = [1000, 1000, 0, 0];
          },
          getValueAt: function (point) {
            var value;
            var shadowCtx = this.shadowCtx;
            var img = shadowCtx.getImageData(point.x, point.y, 1, 1);
            var data = img.data[3];
            var max = this._max;
            var min = this._min;
            value = Math.abs(max - min) * (data / 255) >> 0;
            return value;
          },
          getDataURL: function () {
            return this.canvas.toDataURL();
          }
        };
        return Canvas2dRenderer;
      }();

      var Renderer = function RendererClosure() {
        var rendererFn = false;

        if (HeatmapConfig.defaultRenderer === 'canvas2d') {
          rendererFn = Canvas2dRenderer;
        }

        return rendererFn;
      }();

      var Util = {
        merge: function () {
          var merged = {};
          var argsLen = arguments.length;

          for (var i = 0; i < argsLen; i++) {
            var obj = arguments[i];

            for (var key in obj) {
              merged[key] = obj[key];
            }
          }

          return merged;
        }
      }; // Heatmap Constructor

      var Heatmap = function HeatmapClosure() {
        var Coordinator = function CoordinatorClosure() {
          function Coordinator() {
            this.cStore = {};
          }
          Coordinator.prototype = {
            on: function (evtName, callback, scope) {
              var cStore = this.cStore;

              if (!cStore[evtName]) {
                cStore[evtName] = [];
              }

              cStore[evtName].push(function (data) {
                return callback.call(scope, data);
              });
            },
            emit: function (evtName, data) {
              var cStore = this.cStore;

              if (cStore[evtName]) {
                var len = cStore[evtName].length;

                for (var i = 0; i < len; i++) {
                  var callback = cStore[evtName][i];
                  callback(data);
                }
              }
            }
          };
          return Coordinator;
        }();

        var _connect = function (scope) {
          var renderer = scope._renderer;
          var coordinator = scope._coordinator;
          var store = scope._store;
          coordinator.on('renderpartial', renderer.renderPartial, renderer);
          coordinator.on('renderall', renderer.renderAll, renderer);
          coordinator.on('extremachange', function (data) {
            scope._config.onExtremaChange && scope._config.onExtremaChange({
              min: data.min,
              max: data.max,
              gradient: scope._config.gradient || scope._config.defaultGradient
            });
          });
          store.setCoordinator(coordinator);
        };

        function Heatmap() {
          var config = this._config = Util.merge(HeatmapConfig, arguments[0] || {});
          this._coordinator = new Coordinator();

          if (config.plugin) {
            var pluginToLoad = config.plugin;

            if (!HeatmapConfig.plugins[pluginToLoad]) {
              throw new Error('Plugin \'' + pluginToLoad + '\' not found. Maybe it was not registered.');
            } else {
              var plugin = HeatmapConfig.plugins[pluginToLoad]; // set plugin renderer and store

              this._renderer = new plugin.renderer(config);
              this._store = new plugin.store(config);
            }
          } else {
            this._renderer = new Renderer(config);
            this._store = new Store(config);
          }

          _connect(this);
        }
        // add API documentation

        Heatmap.prototype = {
          addData: function () {
            this._store.addData.apply(this._store, arguments);

            return this;
          },
          removeData: function () {
            this._store.removeData && this._store.removeData.apply(this._store, arguments);
            return this;
          },
          setData: function () {
            this._store.setData.apply(this._store, arguments);

            return this;
          },
          setDataMax: function () {
            this._store.setDataMax.apply(this._store, arguments);

            return this;
          },
          setDataMin: function () {
            this._store.setDataMin.apply(this._store, arguments);

            return this;
          },
          configure: function (config) {
            this._config = Util.merge(this._config, config);

            this._renderer.updateConfig(this._config);

            this._coordinator.emit('renderall', this._store._getInternalData());

            return this;
          },
          repaint: function () {
            this._coordinator.emit('renderall', this._store._getInternalData());

            return this;
          },
          getData: function () {
            return this._store.getData();
          },
          getDataURL: function () {
            return this._renderer.getDataURL();
          },
          getValueAt: function (point) {
            if (this._store.getValueAt) {
              return this._store.getValueAt(point);
            } else if (this._renderer.getValueAt) {
              return this._renderer.getValueAt(point);
            } else {
              return null;
            }
          }
        };
        return Heatmap;
      }(); // core


      var heatmapFactory = {
        create: function (config) {
          return new Heatmap(config);
        },
        register: function (pluginKey, plugin) {
          HeatmapConfig.plugins[pluginKey] = plugin;
        }
      };
      return heatmapFactory;
    });
  });

  function ColorRangeMaker(option) {
    var vRange = option.value[1] - option.value[0];

    if (option.color.length === 2) {
      // 仅有两个颜色
      var rA = (option.color[1][0] - option.color[0][0]) / vRange;
      var gA = (option.color[1][1] - option.color[0][1]) / vRange;
      var bA = (option.color[1][2] - option.color[0][2]) / vRange;
      this.option = {
        vRange: vRange,
        rA: rA,
        gA: gA,
        bA: bA,
        option: option
      };
    } else {
      // 两个以上颜色
      var makers = [];
      var vA = vRange / (option.color.length - 1);

      for (var i = 1; i < option.color.length; i++) {
        var maker = new ColorRangeMaker({
          color: [option.color[i - 1], option.color[i]],
          value: [option.value[0] + vA * (i - 1), option.value[0] + vA * i]
        });
        makers.push(maker);
      }

      this.option = {
        makers,
        vA,
        option
      };
    }
  }

  ColorRangeMaker.prototype.make = function (value) {
    var makers = this.option.makers;
    var rA = this.option.rA;
    var gA = this.option.gA;
    var bA = this.option.bA;
    var vA = this.option.vA;
    var option = this.option.option;

    if (value < option.value[0]) {
      return option.color[0];
    } else if (value > option.value[option.value.length - 1]) {
      return option.color[option.color.length - 1];
    } else {
      if (option.color.length === 2) {
        // 仅有两个颜色
        var color = option.color[0].map(a => a);
        var vATmp = value - option.value[0];
        color[0] += parseInt(rA * vATmp);
        color[1] += parseInt(gA * vATmp);
        color[2] += parseInt(bA * vATmp);
        return color;
      } else {
        for (var i = 1; i < option.color.length; i++) {
          if (value <= option.value[0] + vA * i) {
            return makers[i - 1].make(value);
          }
        }
      }
    }
  };

  function styleInject(css, ref) {
    if ( ref === void 0 ) ref = {};
    var insertAt = ref.insertAt;

    if (!css || typeof document === 'undefined') { return; }

    var head = document.head || document.getElementsByTagName('head')[0];
    var style = document.createElement('style');
    style.type = 'text/css';

    if (insertAt === 'top') {
      if (head.firstChild) {
        head.insertBefore(style, head.firstChild);
      } else {
        head.appendChild(style);
      }
    } else {
      head.appendChild(style);
    }

    if (style.styleSheet) {
      style.styleSheet.cssText = css;
    } else {
      style.appendChild(document.createTextNode(css));
    }
  }

  var css_248z = ".ARK_HEATMAP_AREA {\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 5001;\n}\n\n.ARK_HEATMAP_HEAT {\n    width: 100%;\n    height: 100%;\n}\n\n.ARK_HEATMAP_HEAT_ARKLOADING {\n    position: fixed;\n    top: 0;\n    right: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(255, 255, 255, .5);\n    text-align: center;\n    z-index: 5003;\n}\n\n.ARK_HEATMAP_HEAT_ARKLOADING .ARKLOADING {\n    width: 260px;\n    height: 182px;\n    margin: 0 auto;\n    top: 50%;\n    /*偏移*/\n    margin-top: -91px;\n    position: relative;\n    background-color: rgba(0, 0, 0, .8);\n    border-radius: 4px;\n}\n\n.ARK_HEATMAP_HEAT_ARKLOADING .ARKLOADING .loadingImg {\n    width: 64px;\n    height: 64px;\n    margin: 0 auto;\n    top: 40px;\n    position: relative;\n    background: url(data:image/png;base64,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) no-repeat;\n    background-size: 100% 100%;\n    animation: AROUND linear 2s infinite;\n    -webkit-animation: AROUND linear 2s infinite;\n    /* Safari and Chrome */\n    animation-fill-mode: forwards;\n    /*动画播放完毕时停止，不回到初始状态*/\n    -webkit-animation-fill-mode: forwards;\n}\n\n.ARK_HEATMAP_HEAT_ARKNODATA {\n    position: fixed;\n    top: 0;\n    right: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, .8);\n    text-align: center;\n    z-index: 5003;\n    display: none;\n}\n\n.ARK_HEATMAP_HEAT_ARKNODATA .ARKNODATA {\n    width: 280px;\n    height: 200px;\n    margin: 0 auto;\n    top: 50%;\n    /*偏移*/\n    margin-top: -100px;\n    position: relative;\n}\n\n.ARK_HEATMAP_HEAT_ARKNODATA .ARKNODATA .noDataImg {\n    width: 110px;\n    height: 72px;\n    margin: 0 auto;\n    top: 32px;\n    position: relative;\n    background: url(data:image/png;base64,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) no-repeat;\n    background-size: 100% 100%;\n}\n\n.ARK_HEATMAP_HEAT_ARKNODATA .ARKNODATA .MSG {\n    width: 112px;\n    height: 14px;\n    font-family: PingFangSC-Regular;\n    font-size: 14px;\n    font-weight: normal;\n    font-stretch: normal;\n    line-height: 28px;\n    letter-spacing: 0px;\n    color: #ffffff;\n    position: relative;\n    bottom: -50px;\n}\n\n@-webkit-keyframes AROUND {\n    0% {\n        -webkit-transform: rotate(0deg);\n        -ms-transform: rotate(0deg);\n        transform: rotate(0deg);\n    }\n\n    100% {\n        -webkit-transform: rotate(360deg);\n        -ms-transform: rotate(360deg);\n        transform: rotate(360deg);\n    }\n}\n\n@keyframes AROUND {\n    0% {\n        -webkit-transform: rotate(0deg);\n        -ms-transform: rotate(0deg);\n        transform: rotate(0deg);\n    }\n\n    100% {\n        -webkit-transform: rotate(360deg);\n        -ms-transform: rotate(360deg);\n        transform: rotate(360deg);\n    }\n}\n\n.ARK_HEATMAP_HEAT_ARKLOADING .ARKLOADING .MSG {\n    width: 112px;\n    height: 14px;\n    font-family: PingFangSC-Regular;\n    font-size: 14px;\n    font-weight: normal;\n    font-stretch: normal;\n    line-height: 14px;\n    letter-spacing: 0px;\n    color: #ffffff;\n    position: relative;\n    bottom: -68px;\n\n}\n\n.ARK_HEATMAP_HEAD {\n    width: 100%;\n    height: 64px;\n    top: 0;\n    left: 0;\n    position: fixed;\n    background-color: rgba(0, 0, 0, .8);\n    margin: 0;\n    -webkit-transition: all 0.3s;\n    transition: all 0.3s;\n    z-index: 10001;\n}\n\n/*.ARK_HEATMAP_HEAD_BG {\n    width: 100%;\n    height: 100%;\n    background-color: #000000;\n    opacity: 0.6;\n    position: absolute;\n}*/\n\n.ARK_HEATMAP_HEAD .ARK_HEATMAP_HEAD_LOGO {\n    width: 56px;\n    height: 56px;\n    background: url(data:image/png;base64,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) no-repeat;\n    background-size: 100% 100%;\n    margin-left: 32px;\n    margin-top: 4px;\n    float: left;\n}\n\n.ARK_HEATMAP_HEAD .MENU {\n    display: block;\n    list-style-type: disc;\n    margin-block-start: 12px;\n    margin-block-end: 12px;\n    margin-inline-start: 0px;\n    margin-inline-end: 0px;\n    padding-inline-start: 40px;\n    display: inline-block;\n    float: left;\n    list-style: none;\n    font-size: 24px;\n    margin-left: 32px;\n        margin-top: 0;\n    margin-bottom: 10px;\n    \n}\n\n.ARK_HEATMAP_HEAD .MENU li {\n    width: 136px;\n    height: 62px;\n    float: left;\n    margin-right: 31px;\n    position: relative;\n}\n\n.ARK_HEATMAP_HEAD .MENU li a {\n    line-height: 56px;\n    width: 132px;\n    text-decoration: none;\n    display: inline-block;\n    text-align: left;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li div.setting {\n    line-height: 56px;\n    margin-right: 15px;\n    text-decoration: none;\n    display: inline-block;\n    text-align: left;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li div.setting {\n    cursor: pointer;\n}\n\n.ARK_HEATMAP_HEAD .MENU li a .icon,\n.ARK_HEATMAP_HEAD .CONTROL li div.setting .icon {\n    width: 14px;\n    height: 14px;\n    float: left;\n    margin: 24px 13px 23px 1px;\n}\n\n.ARK_HEATMAP_HEAD .MENU li a .icon.point {\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAQFJREFUOBGlUr0SwUAQ3jOoNPqM51AoFGkUCi+gyYyOd1B4ATqTNGqhUGivUHgOo6agwljZi5XFBSM3k/n225/vLjsfQMajfp2fLFaV8+kSIEJVKVgXinmv3axtcizgz3TfD/WOkHMS42F0AbCEiC5xqj8EAKELiGWDcvIe080yzTwRUDACpfZAaDn0bJlmnnkHVoFgrht4hTHdqHLQ8Vr1pbxdxskviKwZRnSinTgsJMpPoVXgqeMLsQrQs6OFbukz8QcR6w5e+9NMRH3mBUGoB/5UHwhfh4mnmYhqRiAyRS92GOH7YdNwRfJ4B8Y86hiZY8hNEtk0nJM88w5Y9G+8AUJVh5AtnshSAAAAAElFTkSuQmCC) no-repeat;\n    background-size: 100% 100%;\n}\n\n.ARK_HEATMAP_HEAD .MENU li a .icon.ele {\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAASNJREFUOBGlU0tOwzAQnYk4AOVE4QqEE5Rsu6nEAqS2Il10gdQF7TLlBIQrkBPRniBmnvFL3Tbho47kzHh+fvPsiJwpivpNVRemRraWd1k6hy8Wi09sP3YqL/lNOotjbLB1zl3GgU5bdZtn6VUcuwibpelCEi2OT0C8fK+fpHHTROQ55J+q8u3DnXr3nr44Eewzf7GO+fhXA6AwCUcoSJ/ZWH+X/PZaTaaoIB++QYD1TVZHP0+i+ZHHax5m6QKpHGHs64xpg+lP8Ht+GsIW5B28E46wMmg7wANM1EFzJaqPYm8AD4k9f9R9V8aiOE4EjMlrVT9gQ17aQDDop/Zw46Syqj/FuUHs67IxshE6IIltjnVc27y9PxYQNiL3xseqLTrH+AJbgG7owrT0fAAAAABJRU5ErkJggg==) no-repeat;\n    background-size: 100% 100%;\n}\n\n.ARK_HEATMAP_HEAD .MENU li a .icon.dep {\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsSAAALEgHS3X78AAAA2UlEQVQ4y63SsU3EMBjF8V9QBmAENkhqGswEIKVFAikL3AjcBmkpImCASGxwuQ1yDTUj3AamMegKEoPCV9nfZ/k9//2KGKM1dWZlldAP44Rq5syhbUKdc1AtiFRZB7nqh/FHUG0TimItxPIX6jU6XJ20X7Fpm3AsYoxzEA94wJj2L3jHJe7TPCxBrPCY1gETntKF12m+yeXgJikf8YwturYJI/YIixD7YXxL6he4TSwCzrHDNufg6wkfqHGXuOwSg24O4nf6cr9QzkCsTsIyJdt/y8Fc+v49iZ9JZE9S7l9DngAAAABJRU5ErkJggg==) no-repeat;\n    background-size: 100% 100%;\n}\n\n\n\n.ARK_HEATMAP_HEAD .CONTROL li div.setting .icon {\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAkVJREFUOBGlU01rU1EQnbmvbVKRQkGRulB04VJREGtE0+yUKDRJCdQUtE2R+gEWd+JPKEh1pZKkRWgE5SUVSrZJqxRd+bETV3XRKmIFgySveXnjmZdGVNxULyR35s45M2fu3Ef0n4v/xp9beNZbd9xXIrS3FecPPdu7DidPh9b/xJtfD8rlcof69UazX8lszIjFJkUke759d49rrI1RW9dPBVm7EiORJzh6KUyaaP94YmCnghD7hG2FhBpC1M9kkumhU7bGfAWPl5e7Yd8R5hJSrqKixSwxBeiyyMRBZo0x04KwN73J8StRda1xBZJ7rW65NBqNfFRS1i5fzNiVKbU99h6kEwNH1c4/fbGr5tbfV1c3rsGd8hWwUBBOwHNoUEG5YmVYhLPo7y3UvPE8yszYi+c1VnedQRQLCktAff8OBOhcYem2iDfZabbtcL1anlg+pxOREQXhDh5i6wsGrGSt7q6jl7tjifAko8/fpqDgrS4/Qa6weBMqrrKhyxfix76wRbMQNYzK9zN2+R4kpwzxTOrsya+GzQSKTGQLlVtabFMBO7AdE6B5PRyLDTyCujRGdhBdHjKGxkcT4bzGgh2BeTTusPic1h3oSKprG+9AeI1LcYRkH8Y1mY5Hnitp1l460RRvGveygoSdwB3p6es6kAyFar4CNYC7jllH8dsNUBMtFJWsq0leAaWQl/vgnoN9Y5PTUuCj8KfPNBKJuNli5Yw0paRP2YCG6nN4TNHRoXBJ1bbJyvPH2E7Q3rfyMbU5/7z/AAW19JLkSsU0AAAAAElFTkSuQmCC) no-repeat;\n    background-size: 100% 100%;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li div.setting .icon.content {\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAASBJREFUOBFjYKAQMML0z99wUPfv33/+QAEWmBg2+j8Dwx9WFuZN8f52l0DycMV///5fw/CfQQ2ogCD48+dvClCRAkghE4gAAaDN1yAswuT//wwXYKrgBvBKskUxMjLshEngohkZGM8wsrLGwuThYQASWHX1KtvnG69X/v//PwCmAJkGar7GwsRpFx9k/hYmDncBSCBMW/uXktD/UAZGxmUwBQia8T4DK4srsmaQHIoLYIqBLmCau/bAPCA/HqKI8TUjI7NFUrDtPZgaGI3iApggIyPjPyYmhjUwPgPj/2vYNIPksRoA10gEYxAbwMPFfgwYxHcJ+QKnF8I8rN4xMLA5AwP08f//jDhTOE4DQDanBFs/ZGRgdmBkZugi5BKy5QFInkUD9ZJAawAAAABJRU5ErkJggg==) no-repeat;\n    background-size: 100% 100%;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li div.setting .icon.element {\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAQ9JREFUOBFjYBhowAhywNx1B9sZ/v3XF2PnCfH1Nfm2cP0hsz8M/4TxOY6ZgflVQqDtWZb///8zzlt7MPk/w3/RV7+/qwI1Xfzz798UIC2Bz4C/DH/vA+XtwWrmbDxoOG/dIX98Gmgrt3//fpZVu8/wk2MLJBDXHDj3n5FBnYmZUSMpwP7x3LUHmoBhIkbAwCcpwY4tLCBF/xn//2ME6mD7+/8/iA9k/wFSIIwPIORX/f/PPHfjEV58qmkrN3fjfpO5aw4Fk2MLIyghAVPiK4b//0WYmRkMEwMdL8yFBCrehAQMp/vJIQ7WLIyMjP+BKXHGP0YGfW5xtpsgVzAzM6f+//9XCK+LmP6/xitPN0kASiVn0SyQwN4AAAAASUVORK5CYII=) no-repeat;\n    background-size: 100% 100%;\n}\n\n.ARK_HEATMAP_HEAD .MENU li a span,\n.ARK_HEATMAP_HEAD .CONTROL li div.setting span {\n    font-family: PingFang-SC-Medium;\n    font-size: 16px;\n    font-weight: normal;\n    font-stretch: normal;\n    line-height: 62px;\n    letter-spacing: 0px;\n    color: #9cacbf;\n}\n\n.ARK_HEATMAP_HEAD .MENU li a:hover,\n.ARK_HEATMAP_HEAD .MENU li a.active {\n    border-bottom: 2px solid #1489e2;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li div.setting:hover,\n.ARK_HEATMAP_HEAD .CONTROL li div.setting.active {\n    border-bottom: 0;\n}\n\n.ARK_HEATMAP_HEAD .MENU li a:hover span,\n.ARK_HEATMAP_HEAD .MENU li a.active span {\n    color: #1489e2;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li div.setting:hover span,\n.ARK_HEATMAP_HEAD .CONTROL li div.setting.active span {\n    color: #ffffff;\n}\n\n.ARK_HEATMAP_HEAD .MENU li a:hover .icon.point,\n.ARK_HEATMAP_HEAD .MENU li a.active .icon.point {\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAQFJREFUOBGlUjEKwlAMTVR0cRGsQ1HP4QFcPIfgZl28gINDi4t2EzyHV/AcrXQRdNBFUWPTNiWUFsV+KC8vfXk/PwSg5MFf68110H/cnzskHBDSod6ojYOZ6VXEoOP4i7btnRklp5GLgWBIQE3GiIeC1OBNNA15K0FdG8V8s04KTw0qiG4ouCSotVHMbeuk8NIzyDUwVv6IXrDlG7EKk9O8t9e36zh9gk7GxdQFoK4Y6f86zjXQgm9xrgG3HTZ/5C+Oi21yZ5CVFy0R66IODMdbGrZ/ZcwWMy9aIv4XP4HQijcMLU5mjyyN5DVPZkAuAt4AaSMijbI0ktO89AzE9G/8AFToh10DAaI4AAAAAElFTkSuQmCC) no-repeat;\n    background-size: 100% 100%;\n}\n\n.ARK_HEATMAP_HEAD .MENU li a:hover .icon.ele,\n.ARK_HEATMAP_HEAD .MENU li a.active .icon.ele {\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAQZJREFUOBGtUsEOwUAQnZn4AKTc9A8dERJt1IkmDuoLy0ka9QW7ZpZlrUUqNml23ryZ2bdvC/CP1V8dsmhd1lFezkPzJC98f71f+DxKQkjQ0PbJAK6rSdx18y0DEDY8ICPE7DgepG6BxHKy0jpBotzn7jhalfoOAsE7ngK1H1O+H9crfGx5kEaFumIFeshR2kgBG4hAkMiIJz+MLPYg9ExSLHk53T6z60ezZ0Q4V+O4IwOMGh5urkCaCmBS5FlCdvux3BnX1gS4FUVflysxVOzyLyb28sNUmux9/QE2b3fjgVvE00+MO24uGN/8ePkPCGinUA3Zk001ipd+syjUSo3Yj8LnfsIXR3J0GEi1vfgAAAAASUVORK5CYII=) no-repeat;\n    background-size: 100% 100%;\n}\n\n.ARK_HEATMAP_HEAD .MENU li a:hover .icon.dep,\n.ARK_HEATMAP_HEAD .MENU li a.active .icon.dep {\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsSAAALEgHS3X78AAAA10lEQVQ4y63SsU3DQBjF8Z9RBqBxaYkN7JoGMwEMgBRGSOWatK7cUgEbsEGSDZKGOpJLN9ngaA5EEfsima+6+77TvXf/e1kIwZy6MrMWkLf9HuXImcPQFFXKQTkhUiYdpCpv+7OghqbIsrkQFxeoV+hw96f9gdXQFKcshDAG8YBnbOP+HV+4xTLO6ymIJV7iusYer/HC+zhfpXLwEJVPeMMa3dAUW+xQT0LM2/4zqt/gMbKocY0N1ikHP084osJT5LKJDLoxiL/pu/QXwrmQzMrBWPr+PYnfX8xTYCBLOCIAAAAASUVORK5CYII=) no-repeat;\n    background-size: 100% 100%;\n}\n\n\n.ARK_HEATMAP_HEAD .CONTROL li div.setting:hover .icon,\n.ARK_HEATMAP_HEAD .CONTROL li div.setting.active .icon {\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAURJREFUOBG1kz9LglEUh71WaGM55OrSB3DtE1RLFg3qUpOOgbhE3yHdCmqJPkIE0WpETurWpksQbTWEUb09v/vea68IKoIHHs655/zuee+/NxabhwVBsAJd8NYjWJ34LUSLEuE33cwivuDibVezmpFmiHLwDQ/wBG9eRPwKTVDtB/Z8Le66LuPrcAsvsAA58LZLYEC1G6jRRHNCY1CBD0hHcgeMHx2HkfwauXeoKmdXgE9CAnZAZ5DHXUIH2nBBroCXSeP1NqEJBk5BloI7uA6rtuEV43vQ7cjqoC0NVuC1s3m6HcMXlNUBnwed9jmcudhugbgEfTgZfI3BzIdo90EDXckztKAPGTgyxjTwWtEGrgY9WIIsrFP/xIeGSA9Jy570kH7R7Pt5Q57CuKe8JTGa/wc0NDsyQKTr6oK36X6mSI+pwz+2s2sE4j6K/AAAAABJRU5ErkJggg==) no-repeat;\n    background-size: 100% 100%;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li div.setting:hover .icon.content,\n.ARK_HEATMAP_HEAD .CONTROL li div.setting.active .icon.content {\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAALRJREFUOBFjYKAQMML0////XxfI9gdiFpgYDvoPUHwTIyPjJRR5oAE3gZhY8ACmmQnGANLXkNiEmBcwFACt5gTiHUQ44TRQDS+GASABoAQbEK/HY8hVoJwwVs0wQaACFiBeisWQe0AxKZg6vDRQIRMQL0Ay5BWQrYRXE7okUIMPkgEH0OVhfORYgImRRA9uA44B/XKXkH9wegGY1t8BNTsD8WMg/k/IIJzyoOgDYk+cCiiVAABBtddgMn4BogAAAABJRU5ErkJggg==) no-repeat;\n    background-size: 100% 100%;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li div.setting:hover .icon.element,\n.ARK_HEATMAP_HEAD .CONTROL li div.setting.active .icon.element {\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAMlJREFUOBFjYBhowAhywP///9uBlD4QhzAyMn4D8s2AbGEgxgdeAdWeZQQqBhnyEohFgdgAKHgRKHYKyJYAYnzgPlCtPVgBUIMhEPvjU01bOaDtLEDMT44tsEA8B9SsDsQaQH89BhrWBGSLETDwCVBtCwtU0T8g/R+KQUJ/oBjExgVAaiAAaCMzEPPC+PSngbabAHEwOTbDEtIroGYRIDYEBswFoGGgQCUmIVmzADUA1f+fAdQASso3gRgEUoFYCMzCTbzGLUVPGQAuSE4Qo6rhyQAAAABJRU5ErkJggg==) no-repeat;\n    background-size: 100% 100%;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .ARK_CONTENT_LIST {\n    position: relative;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .CROWD_NAME {\n    font-family: PingFang-SC-Medium;\n    font-size: 13px;\n    font-weight: normal;\n    font-stretch: normal;\n    line-height: 13px;\n    letter-spacing: 0px;\n    color: #6d859e;\n    float: left;\n    display: block;\n    width: 100%;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li #ARK_SETTING_CONTENT_ELEMENT_LIST {\n    width: 470px;\n    left: -159px;\n    z-index: 10009;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .CROWD_ELEMENT_NAME {\n    float: left;\n    display: block;\n    width: 100%;\n    font-family: PingFangSC-Regular;\n    font-size: 16px;\n    font-weight: normal;\n    font-stretch: normal;\n    line-height: 16px;\n    letter-spacing: 0px;\n    color: #252d39;\n    margin-bottom: 5px;\n\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .CROWD_ELEMENT_TABLE {\n    width: 100%;\n\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .CROWD_ELEMENT_TABLE td {\n    font-family: PingFangSC-Regular;\n    font-size: 14px;\n    font-weight: normal;\n    font-stretch: normal;\n    line-height: 40px;\n    letter-spacing: 0px;\n    color: #4c6072;\n    padding: 0 12px;\n    text-align: right;\n    white-space: nowrap;\n\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .CROWD_ELEMENT_TABLE tbody {\n    display: block;\n\n    max-height: 400px;\n\n    overflow-y: auto;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .CROWD_ELEMENT_TABLE tbody::-webkit-scrollbar {\n    width: 4px;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .CROWD_ELEMENT_TABLE tbody::-webkit-scrollbar-thumb {\n    border-radius: 2px;\n    background: hsla(0, 0%, 100%, 0);\n    transition: background 0.2s ease-in-out 0s;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .CROWD_ELEMENT_TABLE tbody:hover::-webkit-scrollbar-thumb {\n    background: #e4eaf1;\n    min-width: 200px;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .CROWD_ELEMENT_TABLE tbody td {\n    max-width: 95px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .CROWD_ELEMENT_TABLE thead,\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .CROWD_ELEMENT_TABLE tr {\n    border-bottom: 1px solid #e4eaf1;\n    display: table;\n\n    width: 100%;\n\n    table-layout: fixed;\n}\n\n/*.ARK_HEATMAP_HEAD .CONTROL li .settingList .CROWD_ELEMENT_TABLE thead {\n    width: calc(100% - 1em)\n}\n*/\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .CROWD_ELEMENT_TABLE thead td {\n    color: #252d39;\n    text-align: center;\n\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .CROWD_ELEMENT_TABLE tbody tr td:nth-child(1),\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .CROWD_ELEMENT_TABLE tbody tr td:nth-child(2) {\n    text-align: left;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .ARKCROWD {\n    padding: 17px 0;\n    line-height: normal;\n    float: left;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .ARKCROWD i.icon_crowd {\n    width: 16px;\n    height: 16px;\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAATtJREFUOBHVUbFKA0EQnd0cKCh+gaKVX5BKbSwsRBIJyGGpgViJiLGxS2Vjgm0IKFHs0iWCoHX+wyJ/kEbU2+fMrnts7oK2OrA3b2bnzc2bJfr3prIKStX6NkAdyStFR4Pb1lO2JoyjMBBsycCixaSk0ZLg8kF9S3y/23oR70178JMvVc9PDeFZjuCwNtdAxubZR3Is5moYFD0pxJLLSfjWbMf2pCii6+ST1iUuMPZ58ekSK7Wz1eRDnYCwo7S+k0sYcwjSx4/d5kDiaWYbsK4YMPcEmkmLWEKB1B7rXuPNxtzoUmmscE3M/+3NLs+3e43Gu5MANCfI3EVrvW9McsGvsuuamgcyNAdWwbNtvL2ONzlfsUsEMKFZCP2bqyGTy45svwuO7DIs1TbOvUJAEJjuKJP/7W5K+Z9NfQHcMWh6c1UmgAAAAABJRU5ErkJggg==) no-repeat;\n    background-size: 100% 100%;\n    float: left;\n    margin-right: 6px;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .ARK_CONTENT_CROWD {\n    position: relative;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .ARKCROWD span {\n    font-family: PingFangSC-Regular;\n    font-size: 12px;\n    font-weight: normal;\n    font-stretch: normal;\n    line-height: 16px;\n    letter-spacing: 0px;\n    color: #354359;\n    float: left;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .ARK_CONTENT_ITEM ul {\n    float: left;\n    margin: 0;\n    padding: 0;\n    display: block;\n    width: 100%;\n    margin-top: 9px;\n    position: relative;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .ARK_CONTENT_ITEM ul li {\n    display: inline-block;\n    list-style: none;\n    font-family: PingFangSC-Regular;\n    font-size: 12px;\n    font-weight: normal;\n    font-stretch: normal;\n    line-height: 20px;\n    letter-spacing: 0px;\n    color: #354359;\n    height: auto;\n    width: 100%;\n    padding: 10px 0;\n    padding-left: 32px;\n    border-left: 1px solid #e4eaf1;\n    word-break: break-word;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .ARK_CONTENT_ITEM .ARK_CONTENT_ITEM_RELATION {\n    width: 20px;\n    height: 21px;\n    border: solid 1px #c5ced8;\n    border-radius: 10px;\n    display: block;\n    position: absolute;\n    top: 50%;\n    margin-top: -10px;\n    left: -10px;\n    font-family: PingFang-SC-Medium;\n    font-size: 12px;\n    font-weight: normal;\n    font-stretch: normal;\n    line-height: 18px;\n    letter-spacing: 0px;\n    color: #9cacbf;\n    text-align: center;\n    background-color: #ffffff;\n    float: none;\n    padding: 0;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList {\n    width: 319px;\n    height: auto;\n    background-color: #ffffff;\n    border-radius: 4px;\n    position: absolute;\n    top: 62px;\n    left: -114px;\n    display: none;\n    padding: 20px;\n    -moz-box-shadow: 0px 0px 6px rgba(37, 45, 57, .2);\n    -webkit-box-shadow: 0px 0px 6px rgba(37, 45, 57, .2);\n    box-shadow: 0px 0px 6px rgba(37, 45, 57, .2);\n    border: 1px solid #D8E0E9;\n}\n\n/*.ARK_HEATMAP_HEAD .MENU li div.setting:hover .settingList,\n.ARK_HEATMAP_HEAD .MENU li div.setting.active .settingList {\n    display: block;\n}*/\n\n\n.ARK_HEATMAP_HEAD .CONTROL {\n    display: inline-block;\n    font-size: 24px;\n    float: right;\n    list-style: none;\n    margin-right: 6px;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li {\n    height: 62px;\n    line-height: 62px;\n    float: left;\n    position: relative;\n}\n\n.ARK_HEATMAP_SWITCH_CHOOSEBTN {\n    display: none;\n}\n\n.ARK_HEATMAP_SWITCH_CHOOSEBTN_LABEL {\n    /*box-shadow: #ccc 0px 0px 0px 1px;*/\n    width: 36px;\n    height: 18px;\n    display: inline-block;\n    border-radius: 9px;\n    position: relative;\n    background-color: #4c6072;\n    overflow: hidden;\n    margin-top: 23px;\n    cursor: pointer;\n}\n\n.ARK_HEATMAP_SWITCH_CHOOSEBTN_LABEL:before {\n    content: '';\n    position: absolute;\n    top: 2px;\n    left: 2px;\n    width: 14px;\n    height: 14px;\n    display: inline-block;\n    border-radius: 20px;\n    background-color: #fff;\n    z-index: 20;\n    -webkit-transition: all 0.5s;\n    transition: all 0.5s;\n}\n\n.ARK_HEATMAP_SWITCH_CHOOSEBTN:checked+label.ARK_HEATMAP_SWITCH_CHOOSEBTN_LABEL:before {\n    left: 20px;\n}\n\n.ARK_HEATMAP_SWITCH_CHOOSEBTN:checked+label.ARK_HEATMAP_SWITCH_CHOOSEBTN_LABEL {\n    background-color: #0095e3;\n}\n\n.ARK_HEATMAP_SWITCH_NAME {\n    font-family: PingFang-SC-Medium;\n    font-size: 16px;\n    font-weight: normal;\n    font-stretch: normal;\n    line-height: 16px;\n    letter-spacing: 0px;\n    color: #9cacbf;\n    width: 64px;\n    height: 62px;\n    line-height: 62px;\n    display: block;\n    float: right;\n    margin-left: 12px;\n    margin-right: 41px;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li a {}\n\n.ARK_HEATMAP_HEAD .CONTROL li a {\n    width: 14px;\n    height: 14px;\n    float: left;\n    margin: 24px 28px 24px 1px;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li a i {\n    display: block;\n    width: 16px;\n    height: 16px;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li a .REFRESH {\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAbJJREFUOBFjYKAlmLvxCO+inRe58dnBiC65bdtt9uffn1b/Z2BIBMpxAPE7hv8MrEyMDLOTgh3a0dWzIAssWndQE6h5HVDsODPTf9vEQMcHIPlV+/fzfP3AoAJiowO4C1Zdvcr2+frrMwyMjBOTg+3noiuE8eev3+8AZF8AGv4BJMYEIkDg041XZQyMDDfxaV62eb/Iv3+Mm/7+ZXgwZ/0hZ5A+hBf+M0QwMTEUggRxgZ+/gN74z7CdkYFRhoOV8RxIHdwFQEFlNjbmM7g0g8QTgx1PMDH/T2dg/K8e7WP7HiQGNwDI/szKzvkPJIgPsLGyMDL8Z4RHLdgAUCgD/X/x86fPS+eu22+Dz4Afv/+Z/mf4fxemBhwGwCgy+f//vykjIyMTJ+v/BJgkVvrf/1SgZStgcmAXAKPkADMzgwIT03+/KF/HNzBJdHru2oPJwEBU59MQ64LJwdMBTABEA+PagFuA4U6Yo+MXKF8BGH11QLYlKyNjUFyQ/XWQOAggohHCB5P//zF6fnrLkDpn7YHfQAGhv/8YfgBtmi/JKW3g5aX6E0kpfiYoI4EyFH5VFMoCAAOqikvhtq9uAAAAAElFTkSuQmCC) no-repeat;\n    background-size: 100% 100%;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li a .HELP {\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAhhJREFUOBGVU81LFVEUP+fOvPfauKldigjasiADNxJBBYFpU0IQFMh740NxkfqyNi36B2LSWvo+bBEFgfLyIwqUIKKVBLWsRYEGbQpypXPvnM6Z1wzTxRbexcw95/zO9+8iWCdorB43WpcQ6BwhdokZib4S4LrjuvVK8eIn0SUHk8vDtbXC7ve9OSD0AeEZEiwp1/1sDBEH6wEwHt9ucLRa4Wh+8ubAwK74xgFi5+3wFQB1cJZipTj4Ngmc/T+oNvsNwAIRbBfacxckiCuAODNAx2GFJ/3i4I7ogupynwFTQu7DUWph2h96Pz3qvavVmr0/iT789RnH2fnmiRBg03Gds0nmoP7iTGSil9z3cy7xB9c5oVANV/yh13Hwxsppo80GV9urNEIJkZ4mzgKIIqrwr3q77I3MlL07gPjIkJkUm5wYy3OSYSsgOK8Qllqm9LuRz+XnUonoFwLqVOaLDFk25fKIO0HlvmSNM6Ne6nx/fuUUb+Aut3A1i2ltSHeprNK+B4+X2wHNKiLeS/q3MVw9fYu0PmYbRDY6GuPVvrnlX5q17TzkbiEYrxHXuY0rDFi0QTmAJ1Q49NvWt+TosrBTuQR1HuS1gFdjA0OCptkLu229EIrJdF2orabK3kehJ6+kwSRp+wesaES1HdnM6gQjbBQfeRcHorJUKYm47a2Eyv99TA7SYrreKOwxhMPS6r6PKVviQZ/zH783DCUq7pYcAAAAAElFTkSuQmCC) no-repeat;\n    background-size: 100% 100%;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li a .RETRACT {\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAATpJREFUOBFjYBjygBGXDzZvPsP18ufnZQyMjGtTgh0W41LHhE1i6ZbDgq9+ftkN1MzE+P9/+9w1B4qwqQOJYRiwcPMx6e8//hxmYGQ4mxxkH8DKzmr1n5EhZd7a/R3YDEHxwsJ1h9X+/P+7Eyg4KynYoR2mAeSi7z/+bgTadpsn2D4tjJHxL0wObsDcjftN/v9h3MTEyFCdFOQwHz0Mtm27zf7s+9PFDP//szELM0QkOjr+ABkC9wJQcxmQmwrSjC0MvLxUfwK9FM7AwHjv/zsmfwwXwARAYfD758+dDIxM+5OD7PIXbzkq8+vXnx1MDP83JQU7VsDUwWi4F0ACkDD4swtoy6zkYIc2mCKiw4DhN+Pm/0yM1SlB9vNgmmE0MWHQBgyQNGyaQYbgCgOYBcDA/Q8PULjgkGAAANSfnuk3RoEUAAAAAElFTkSuQmCC) no-repeat;\n    background-size: 100% 100%;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li a:hover .REFRESH {\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAQ1JREFUOBG1ks8KAVEUxmckFijkAWztZqMsLJQsPIc8hLLyIKws5Dk8AClZsLFkIRZIGb8zXN07l/wpt36dc77vu3eaO+M4/1y+76cg8dUz2BCHDqxgDXNYQuvtQYQKMIMu5NUG+iR4an5aCcRgAo2ngbuIX4G0lUFsw9AyNAE/BzvYQlWzHAdhCjVDDA34JRjACDKGjXCwRCNxG8ikYaOsiGqoe7ho86vWxXh82uAATkwijqFPX361864XqQsjwya5WbkYuaCcYYYG/CG0Q3JwifJuFcvQBPwGyKeOabLdEvBAXitY9HmQn0t+soLSpUb1Qevr9E3CZ2oWjtADz3XdE/WzxQEJSH2W/jF1BQYvzfgwrEoEAAAAAElFTkSuQmCC) no-repeat;\n    background-size: 100% 100%;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li a:hover .HELP {\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAWdJREFUOBGNk79Kw1AUhxuX0qGLjo5SXEyXgiK1dFBcXNRdV7fiWwgurVudVPoAxReQPIOTUAc76SAUg7goxO8XcpPjjUovfLnn/M6f5ObeW6l4I0mSEPpwD3GGbGmhl164BKswhE8YwSGo2RrswxUoppxqUYklASJ4hM6PoHGItWECyi2a4KiriusuH3s90y+ZN41ex1fuMNUwmqBPy9+M3YUPuIFzeIdd06SDr5ow4DEgsBgEwbFJuMWeovWkkXPG1MTfk6+BNmJ6XeCxA2Ow4w7nwggz7C/jy1TNtjppq/7cHmIteIN8CapWDcT/NiBhGV7gVEV2oKUNtIQpNGzQ2CfYEWvXf/LHCsKT+4lLJB35GbxlFS0m9vxL7BptpiWUttElE3uALee7Ga0N6TamGk7pICmAvgE1V5hpOkgT1eQ6zrxHWQdIpzBSTd4g6+xfpgOS9KeFbF0wfXb5MtlOJKhg7uv8DahvoK6C+lwsAAAAAElFTkSuQmCC) no-repeat;\n    background-size: 100% 100%;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li a:hover .RETRACT {\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAALpJREFUOBFjYBi+4P///1xAvAGIY0n2JVCTIBAfBeJNQPwEiIuINgSoWBqIrwDxJCBmAmI5IL4GxB0EDQEqUgPi+0BciawYyAe56BAQzwViZmQ5OBsoYQLEz4A4ESQIpFHCAMhnB+JVQAwKFw64RhgDKukN1Yw1DIBqGIG4D4jDYfowaKAkLAwmA9lkhcEDoMYqZJOBfKLD4DlQcRKyZhgbKE4wDHYBFfnCNGCjgfK4wwAoyYRN0+AXAwDWDeuTwsPrDwAAAABJRU5ErkJggg==) no-repeat;\n    background-size: 100% 100%;\n}\n\n.ARK_HEATMAP_HEAD .OPEN {\n    display: none;\n    position: absolute;\n    width: 64px;\n    height: 32px;\n    right: 56px;\n    top: 64px;\n    background-color: rgba(20, 137, 226, 0.8);\n}\n\n.ARK_HEATMAP_HEAD .OPEN:hover>.ARKTOOLTIP {\n    display: block;\n}\n\n.ARK_HEATMAP_HEAD .ARKTOOLTIP {\n    padding: 8px 16px;\n    position: absolute;\n    z-index: 1070;\n    display: none;\n    font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif;\n    font-size: 12px;\n    font-style: normal;\n    font-weight: 400;\n    line-height: 1.42857143;\n    text-align: left;\n    text-align: start;\n    text-decoration: none;\n    text-shadow: none;\n    text-transform: none;\n    letter-spacing: normal;\n    word-break: normal;\n    word-spacing: normal;\n    word-wrap: normal;\n    white-space: normal;\n    filter: alpha(opacity=0);\n    opacity: 1;\n    line-break: auto;\n    top: 52px;\n    background: rgba(255, 255, 255, 1);\n    border-radius: 5px;\n    -moz-box-shadow: 0px 0px 6px rgba(37, 45, 57, .2);\n    -webkit-box-shadow: 0px 0px 6px rgba(37, 45, 57, .2);\n    box-shadow: 0px 0px 6px rgba(37, 45, 57, .2);\n    border: 1px solid #D8E0E9;\n}\n\n.ARK_HEATMAP_HEAD li .settingList .ARROWLIST,\n.ARK_HEAT_ELEMENT_POINT_MSG .ARROWLIST {\n    position: absolute;\n    width: 0;\n    height: 0;\n    border-color: transparent;\n    border-style: solid;\n    top: 5px;\n    left: 50%;\n    margin-top: -10px;\n    border-width: 0 7px 5px;\n    border-bottom-color: #fff;\n    /* right: 0; */\n    margin-left: -7px;\n}\n\n.ARK_HEATMAP_HEAD .ARKTOOLTIP .ARROW {\n    position: absolute;\n    width: 0;\n    height: 0;\n    border-color: transparent;\n    border-style: solid;\n    top: 5px;\n    left: 50%;\n    margin-top: -10px;\n    border-width: 0 5px 5px;\n    border-bottom-color: #fff;\n    /* right: 0; */\n    margin-left: -5px;\n}\n\n.ARK_HEATMAP_HEAD .ARKTOOLTIP .WORDS {\n    max-width: 200px;\n    color: #354359;\n    text-align: center;\n    border-radius: 4px;\n    white-space: nowrap;\n}\n\n.ARK_HEATMAP_HEAD li a:hover+.ARKTOOLTIP {\n    display: block;\n}\n\n.ARK_HEATMAP_HEAD .OPEN .OPENICON {\n    width: 12px;\n    height: 11px;\n    display: block;\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAMBJREFUOBHVkDEOgkAQRREKDZ01ia0X4BbGmsoCjkAHJ7CykNoLUBkraxNvoDUWRI+xvDVigJ1sQQfJy87+P7O7fMeZ5KeUctuH/wvECA4wa01pxd+iXw0PYwFnKGFuNCCgJ/CBUPJ1gwcnuMGy28Q+hxesu7pY07SHJ6zAhQIeEIgDWsTsZcA+hRoucIfvi1g3UBoHIRoZoO1A5+L/Lomp3zAqg4zBCkZlcGTQnsHwnxgQMxj2Wfcc0svA2jxdswGlxeiWZHja3AAAAABJRU5ErkJggg==) no-repeat;\n    background-size: 100% 100%;\n    margin: 10px auto;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .SETTINGITEM {\n    display: block;\n    width: 100%;\n    height: 18px;\n    margin-bottom: 17px;\n    position: relative;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .SETTINGITEM span {\n    font-family: PingFang-SC-Medium;\n    font-size: 13px;\n    font-weight: normal;\n    font-stretch: normal;\n    color: #4c6072 !important;\n    float: left;\n    height: auto;\n    line-height: normal;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .SETTINGITEM .ARK_HEATMAP_SWITCH_CHOOSEBTN_LABEL {\n    margin: 0;\n    margin-left: 28px;\n    float: left;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .SETTINGITEM i.ARK_TIPS {\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAWRJREFUOBGtUz1LA0EQnZdY2Fj5E7RNLbZ2yt1ZGbDLBRFsk0PBQtFCUC5/QCSxjpWJaJdWrBTS6k+wsrFJxn2rczkDUTAe7M3smzdvP2ZWZMoP4/lRdXdOdZCoSgToIuOqeAakAxTTTvPsLZ/zTSCMkxUVbUL01QUuFOiTDNWSimypYB6CareV9kwkE2CyW+rOBY5m15ZOr8rlgZFoN9rt4vvtw55zDwVYNREvwG0PddCHynn3snFiiUE1WaZ/00zvDQsr9X2FbBdQLPE4BQZ4Zm6bKxuRFkPd5Mhj5JDLnAwP4tpTFNd2MuAXh9ygUn8kbYY/d44FuzDO7Qvj+gH9bqtxbBgtuW4XvkJeIB/M+wD8EfPYuP95ByIvLNV4cNLcl9X1BuNewNX2mnVmqSYlGU4OuWyskYDrMDbJV52Nyw7q+TFChBzfUC6H8P80ki0wVSubSPaYRNdZXuI/PSbL+7P9AEkWrrzcUUUXAAAAAElFTkSuQmCC) no-repeat;\n    background-size: 100%;\n    width: 16px;\n    height: 16px;\n    cursor: pointer;\n    float: left;\n    margin-left: 5px;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .SETTINGITEM i.ARK_TIPS.active+.ARKTOOLTIP,\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .SETTINGITEM i.ARK_TIPS:hover+.ARKTOOLTIP {\n    display: block;\n    white-space: normal;\n    background: #252d39;\n    top: 22px;\n    -moz-box-shadow: none;\n    -webkit-box-shadow: none;\n    box-shadow: none;\n    border: 0;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .SETTINGITEM .ARKTOOLTIP .WORDS {\n    white-space: normal;\n    color: #c5ced8;\n    text-align: left;\n    font-size: 14px;\n    line-height: 1.5;\n}\n\n.ARK_HEATMAP_HEAD .CONTROL li .settingList .SETTINGITEM .ARKTOOLTIP .ARROW {\n    border-bottom-color: #252d39;\n    border-width: 0 7px 5px;\n    margin-left: -7px;\n}\n\n.ARK_RANGE_TWO {\n    width: 150px;\n    height: 4px;\n    border-radius: 2px;\n    background: -moz-linear-gradient(left, #3023ae 0%, #53a0fd 20%, #b4ec51 41%, #ffa301 81%, #fb0000 100%);\n    background: -webkit-gradient(linear, left right, left right, color-stop(0%, #3023ae), color-stop(20%, #53a0fd), color-stop(41%, #b4ec51), color-stop(81%, #ffa301), color-stop(100%, #fb0000));\n    background: -webkit-linear-gradient(left, #3023ae 0%, #53a0fd 20%, #b4ec51 41%, #ffa301 81%, #fb0000 100%);\n    background: -o-linear-gradient(left, #3023ae 0%, #53a0fd 20%, #b4ec51 41%, #ffa301 81%, #fb0000 100%);\n    background: -ms-linear-gradient(left, #3023ae 0%, #53a0fd 20%, #b4ec51 41%, #ffa301 81%, #fb0000 100%);\n    background: linear-gradient(to right, #3023ae 0%, #53a0fd 20%, #b4ec51 41%, #ffa301 81%, #fb0000 100%);\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#3023ae', endColorstr='#fb0000', GradientType=0);\n    float: right;\n    margin-top: 6px;\n    margin-right: 12px;\n    position: relative;\n}\n\n.ARK_RANGE_TWO_BG {\n    position: absolute;\n    z-index: 1;\n    top: 0px;\n    height: 4px;\n    overflow: hidden;\n    background: #9cacbf;\n    width: 30%;\n}\n\n.ARK_RANGE_TWO_SLIDER {\n    width: 6px;\n    z-index: 2;\n    position: absolute;\n    cursor: pointer;\n    width: 6px;\n    height: 10px;\n    top: -3px;\n    background-color: #ffffff;\n    border-radius: 2px;\n    border: solid 1px #9cacbf;\n    left: 30%;\n}\n\n.ARK_RANGE_ONE {\n    width: 150px;\n    height: 4px;\n    border-radius: 2px;\n    background-color: #0095e3;\n    float: right;\n    margin-top: 6px;\n    margin-right: 12px;\n    position: relative;\n}\n\n.ARK_RANGE_ONE_BG {\n    position: absolute;\n    z-index: 1;\n    top: 0px;\n    height: 4px;\n    overflow: hidden;\n    background-color: #9cacbf;\n    border-radius: 2px;\n    width: 30%;\n}\n\n.ARK_RANGE_ONE_SLIDER {\n    z-index: 2;\n    position: absolute;\n    cursor: pointer;\n    width: 10px;\n    height: 10px;\n    top: -3px;\n    background-color: #e4eaf1;\n    border: solid 1px #9cacbf;\n    border-radius: 4px;\n    left: 70%;\n}\n\n.ARK_RANGE_ONE_NUM {\n    width: 23px;\n    height: 12px;\n    font-family: Roboto-Regular;\n    font-size: 12px;\n    font-weight: normal;\n    font-stretch: normal;\n    line-height: 12px;\n    letter-spacing: 0px;\n    color: #354358;\n    position: absolute;\n    top: -17px;\n}\n\n.ARK_HEAT_ELEMENT_POINT {\n    position: absolute;\n    text-align: center;\n    font-family: Roboto-Bold;\n    font-size: 16px;\n    font-weight: normal;\n    font-stretch: normal;\n    letter-spacing: 0px;\n    color: #ffffff;\n    cursor: pointer;\n    z-index: 1000;\n\n}\n\n.ARK_HEAT_ELEMENT_POINT:hover {\n    z-index: 10000;\n}\n\n.ARK_HEAT_ELEMENT_POINT:hover .ARK_HEAT_ELEMENT_POINT_MSG {\n    display: block;\n}\n\n.ARK_HEAT_ELEMENT_POINT_MSG {\n    background-color: #252d39;\n    border-radius: 4px;\n    position: absolute;\n    top: 0;\n    left: 50%;\n    display: none;\n    padding: 16px;\n    font-family: PingFangSC-Regular;\n    font-size: 14px;\n    font-weight: normal;\n    font-stretch: normal;\n    line-height: 14px;\n    letter-spacing: 0px;\n    color: #9cacbf;\n    -webkit-transform: translateX(-50%);\n    -moz-transform: translateX(-50%);\n    -ms-transform: translateX(-50%);\n    -o-transform: translateX(-50%);\n    transform: translateX(-50%);\n}\n\n.ARK_HEAT_ELEMENT_POINT_MSG .ARROWLIST {\n    border-bottom-color: #252d39;\n}\n\n.ARK_HEAT_ELEMENT_POINT_MSG thead {\n    font-family: PingFangSC-Regular;\n    font-size: 14px;\n    font-weight: normal;\n    font-stretch: normal;\n    line-height: 14px;\n    letter-spacing: 0px;\n    color: #9cacbf;\n    border: 0px;\n    white-space: nowrap;\n}\n\n.ARK_HEAT_ELEMENT_POINT_MSG tbody {\n    font-family: Roboto-Bold;\n    font-size: 18px;\n    font-weight: normal;\n    font-stretch: normal;\n    line-height: 18px;\n    letter-spacing: 0px;\n    color: #ffffff;\n    border: 0px;\n    text-align: right;\n}\n\n\n.ARK_HEAT_ELEMENT_POINT_MSG thead td:nth-child(1) {\n    padding-right: 12px;\n    border-right: 1px solid #354358;\n}\n\n.ARK_HEAT_ELEMENT_POINT_MSG tbody td:nth-child(1) {\n    padding-right: 12px;\n    border-right: 1px solid #354358;\n    padding-top: 8px;\n}\n\n.ARK_HEAT_ELEMENT_POINT_MSG thead td:nth-child(2) {\n    padding-left: 12px;\n}\n\n.ARK_HEAT_ELEMENT_POINT_MSG tbody td:nth-child(2) {\n    padding-left: 12px;\n    padding-top: 8px;\n}\n\n.ARK_HEAT_ELEMENT_POINT_MSG tbody tr {\n    border: 0px;\n}\n\n.ARK_HEAT_ELEMENT_POINT.ARK_OPACITY {\n    opacity: 0;\n}\n\n.ARK_HEAT_ELEMENT_POINT.ARK_OPACITY:hover {\n    opacity: 1;\n}\n\n.ARK_HEAT_ELEMENT_POINT_MSG.up .ARROWLIST {\n    left: 50%;\n    margin-bottom: -10px;\n    border-width: 5px 7px 0;\n    border-bottom-color: transparent;\n    border-top-color: #252d39;\n    top: 82px;\n}";
  styleInject(css_248z);

  // if (top == self && Util.GetUrlParam("arkheatmap").indexOf('true') > -1) {
  //     var arkcontent = Util.GetUrlParam("arkcontent")
  //     if (arkcontent) {
  //         if (arkcontent.charAt(arkcontent.length - 1) == "/") {
  //             arkcontent = arkcontent.substr(0, arkcontent.length - 1);
  //         }
  //         if (arkcontent.charAt(arkcontent.length - 1) == "#") {
  //             arkcontent = arkcontent.substr(0, arkcontent.length - 1);
  //         }
  //         var params = unescape(arkcontent)
  //         var content = JSON.parse(params)
  //         if (content.code === 'ark/depth') {
  //             activeStatus = 'depth'
  //         }
  //         if (content.code === 'ark/element') {
  //             activeStatus = 'element'
  //         }
  //     }
  // }

  var heapmapTemp = `<div class="ARK_HEATMAP_HEAD_LOGO"></div>
        <ul class="MENU">
            <li>
                <a href="javascript:void(0)" id="ARKSHOWPOINT">
                    <i class="icon point"></i>
                    <span>点击位置热图</span>
                </a>
            </li>
            <li>
                <a href="javascript:void(0)" id="ARKSHOWELE">
                    <i class="icon ele"></i>
                    <span>点击元素热图</span>
                </a>
            </li>
            <li>
                <a href="javascript:void(0)" id="ARKSHOWDEP">
                    <i class="icon dep"></i>
                    <span>浏览深度线</span>
                </a>
            </li>
        </ul>
        <ul class="CONTROL">
            <li id="ARK_CONTENT_ELEMENT" >
                <div class="setting">
                    <i class="icon element"></i>
                    <span>热门元素列表</span>
                </div>
                <div class="settingList" id="ARK_SETTING_CONTENT_ELEMENT_LIST">
                    <div class="ARROWLIST"></div>
                    <div class="ARK_CONTENT_CROWD">
                        <span class="CROWD_ELEMENT_NAME">热门点击元素</span>
                        <table class="CROWD_ELEMENT_TABLE">
                            <thead>
                                <td>元素内容</td>
                                <td>元素类型</td>
                                <td>用户数</td>
                                <td>点击次数</td>
                                <td>点击次数占比</td>
                            </thead>
                            <tbody id="ARK_ELEMENT_MAP">
                            </tbody>
                        </table>
                    
                    </div>
                </div>
            </li>
            <li id="ARK_CONTENT_SETTING">
                <div class="setting">
                    <i class="icon content"></i>
                    <span id="ARK_CONTENT_NAME">过滤条件(0)</span>
                </div>
                <div class="settingList" id="ARK_SETTING_CONTENT_LIST">
                    <div class="ARROWLIST"></div>
                        <div class="ARK_CONTENT_CROWD">
                            <span class="CROWD_NAME">分析用户群</span>
                            <div class="ARKCROWD">
                                <i class="icon_crowd"></i>
                                <span id="ARKCONTENTCROWD">所有用户</span>
                            </div>
                        </div>
                        <div class="ARK_CONTENT_CROWD">
                            <span class="CROWD_NAME"  style="margin-top:9px;">过滤条件</span>
                            <div class="ARK_CONTENT_ITEM">
                                <ul id="ARKCONTENTITEM">
                                    <li>无</li>
                                </ul>
                            </div>
                        </div>
                        
                </div>
            </li>

            <li id="ARK_SETTING">
                <div class="setting" >
                    <i class="icon"></i>
                    <span>显示设置</span>
                    
                </div>
                <div class="settingList" id="ARK_SETTING_LIST">
                    <div class="ARROWLIST"></div>
                    <div class="SETTINGITEM">
                        <span>显示浏览深度线</span>
                        <input type="checkbox" name="ARK_DEELP_SWITCH" id="ARK_DEELP_SWITCH" class="ARK_HEATMAP_SWITCH_CHOOSEBTN">
                        <label for="ARK_DEELP_SWITCH" class="ARK_HEATMAP_SWITCH_CHOOSEBTN_LABEL"></label>
                    </div>
                    <div class="SETTINGITEM" id="SETTINGCOLOR">
                        <span>调整颜色范围</span>
                        <i class="ARK_TIPS" id="ARK_RANGE_TWO_TIPS"></i>
                        <div class="ARKTOOLTIP"  id="ARK_RANGE_TWO_TOOLTIP" style="left:-25px">
                            <div class="ARROW"></div>
                            <div class="WORDS">调整左侧滑杆改变热度最低的点显示颜色，以适应默认颜色在背景色上无法突出标识的情况；调整右侧滑杆增加点击较少的点颜色显示范围，以适应因为部分极值导致正常数据范围无法标识出层级的情况</div>
                        </div>
                        <div class="ARK_RANGE_TWO" id="ARK_RANGE_TWO" style="background:none;filter: none;">
                            <div class="ARK_RANGE_TWO" id="ARK_RANGE_TWO_BG" style="position: absolute;top: 0px;height: 4px;margin:0;"></div>
                            <div class="ARK_RANGE_TWO_BG" id="ARK_RANGE_TWO_BG_LEFT"></div>
                            <div class="ARK_RANGE_TWO_SLIDER" id="ARK_RANGE_TWO_SLIDER_LEFT"></div>
                            <div class="ARK_RANGE_TWO_BG" style="right: 0px; width: 6px;background:#fb0000" id="ARK_RANGE_TWO_BG_RIGHT"></div>
                            <div class="ARK_RANGE_TWO_SLIDER" style="left: 144px;background-color:#fb0000" id="ARK_RANGE_TWO_SLIDER_RIGHT"></div>
                        </div>
                        
                    </div>
                    <div class="SETTINGITEM" style="margin:0" id="SETTINGBG">
                        <span>调整背景透明度</span>
                        <i class="ARK_TIPS" id="ARK_RANGE_TIPS"></i>
                        <div class="ARKTOOLTIP" id="ARK_RANGE_TOOLTIP" style="left: -11px;">
                            <div class="ARROW"></div>
                            <div class="WORDS">可以调整热图背景透明度，以适应默认透明度下部分背景网页可能无法识别的情况</div>
                        </div>
                        <div class="ARK_RANGE_ONE" id="ARK_RANGE_ONE">
                            <div class="ARK_RANGE_ONE_BG" id="ARK_RANGE_ONE_BG" style="right: 0"></div>
                            <div class="ARK_RANGE_ONE_SLIDER"  id="ARK_RANGE_ONE_SLIDER"></div>
                            <div class="ARK_RANGE_ONE_NUM" id="ARK_RANGE_ONE_NUM">65%</div>
                        </div>
                        
                    </div>
                </div>
            </li>
            <li id="ARK_HEATMAP_SWITCH_BOX">
                <input type="checkbox" name="ARK_HEATMAP_SWITCH" id="ARK_HEATMAP_SWITCH" checked="true" class="ARK_HEATMAP_SWITCH_CHOOSEBTN">
                <label for="ARK_HEATMAP_SWITCH" class="ARK_HEATMAP_SWITCH_CHOOSEBTN_LABEL"></label>
                <span class="ARK_HEATMAP_SWITCH_NAME">热图显示</span>
            </li>
            <li>
                <a href="javascript:void(0)" id="ARK_REFRESH">
                    <i class="REFRESH"></i>
                </a>
                <div class="ARKTOOLTIP" style="left:-21px;">
                    <div class="ARROW"></div>
                    <div class="WORDS">刷新</span>
                </div>
            </li>
            <li>
                <a href="https://ark.analysys.cn/docs/analytics-heatmap.html" target="_blank">
                    <i class="HELP"></i>
                </a>
                <div class="ARKTOOLTIP" style="left:-33px;">
                    <div class="ARROW"></div>
                    <div class="WORDS">帮助文档</span>
                </div>
            </li>
            <li>
                <a href="javascript:void(0)" id="ARK_CLOSE">
                    <i class="RETRACT"></i>
                </a>
                <div class="ARKTOOLTIP" style="left:-21px;">
                    <div class="ARROW"></div>
                    <div class="WORDS">收起</span>
                </div>
            </li>
        </ul>
        <a href="javascript:void(0)" id="ARK_OPEN" class="OPEN">
            <i class="OPENICON"></i>
            <div class="ARKTOOLTIP" style="left: 3px;top: 32px;">
                    <div class="ARROW"></div>
                    <div class="WORDS">展开</div>
                </div>
        </a>
        `;
  var loading = `
            <div class="ARKLOADING">
                <div class="loadingImg AROUND" id="ARK_HEATMAP_LOADINGImg" style="display:block"></div>
                <div class="noDataImg" id="ARK_HEATMAP_noDataImg" style="display:none"></div>
                <span class="MSG" >生成热图中…</span>
            </div>
            
`;
  var nodata = `
            <div class="ARKNODATA" id="ARK_HEATMAP_noData">
                <div class="noDataImg"></div>
                <span class="MSG" id="ARK_HEATMAP_noData_MSG">当前设备类型下暂无热图回数</span>
            </div>
`;
  var headBtnMap = {};
  /**
   * [buildHeadEle description] 创建头部导航功能条
   * @return {[type]} [description] 返回可操作按钮元素
   */

  function buildHeadEle() {
    var createEle = document.createElement('div');
    createEle.id = 'ARK_HEATMAP_HEAD';
    createEle.className = 'ARK_HEATMAP_HEAD';
    createEle.innerHTML = heapmapTemp;
    createEle.style.display = 'none';
    var domBody = document.body;
    domBody.appendChild(createEle);
    buildBodyEle();
  }

  function buildBodyEle() {
    var loadingEle = Util$1.addEleLable('div', 'ARK_HEATMAP_HEAT_ARKLOADING', 'ARK_HEATMAP_HEAT_ARKLOADING', document.body);
    loadingEle.innerHTML = loading;
    var noDataEle = Util$1.addEleLable('div', 'ARK_HEATMAP_HEAT_ARKNODATA', 'ARK_HEATMAP_HEAT_ARKNODATA', document.body);
    noDataEle.innerHTML = nodata;
  }

  function noDataStatus(code) {
    loadingStatus(false);

    if (code === 200) {
      headBtnMap.noDataEle.style.display = 'none';
      return;
    }

    if (code === 0) {
      headBtnMap.noDataMSG.innerHTML = '暂无数据<br/>小舟建议您选择其他时间范围或过滤条件重试';
    } else if (code === 201) {
      var text = '暂无数据<br/>当前设备类型下暂无热图回数';

      if (heatmapConfig.type === 'depth') {
        text = '暂无数据<br/>当前设备类型下暂无深度线回数';
      }

      if (heatmapConfig.type === 'element') {
        text = '暂无数据<br/>当前设备类型下暂无元素热图回数';
      }

      headBtnMap.noDataMSG.innerHTML = text;
    } else if (code === 400) {
      headBtnMap.noDataMSG.innerHTML = '参数错误<br/>请在方舟中重新打开查看该页面热图';
    } else if (code === 402) {
      headBtnMap.noDataMSG.innerHTML = '查询异常<br/>请稍后重试 或 联系管理员检查热图服务';
    } else if (code === 100) {
      headBtnMap.noDataMSG.innerHTML = '获取数据失败<br/>当前打开的链接已失效<br/>请在方舟中重新打开查看该页面热图';
    } else if (code === 500) {
      headBtnMap.noDataMSG.innerHTML = '获取数据失败<br/>当前网站中AppKey与方舟项目中AppKey不一致，请修改SDK集成代码';
    } else if (code === 1302) {
      headBtnMap.noDataMSG.innerHTML = '获取数据失败<br/>未开启深度线数据采集';
    }

    headBtnMap.noDataEle.style.display = 'block';
  }
  /**
   * [loadingStatus description] 设置loading状态
   * @param  {[type]} status [description] true：展示 false：隐藏
   * @return {[type]}        [description]
   */


  function loadingStatus(status) {
    if (status === true) {
      headBtnMap.loadingEle.style.display = 'block';
    } else {
      headBtnMap.loadingEle.style.display = 'none';
    }
  }
  /**
   * [removeClass description] 移除单个Class
   * @param  {[type]} eleList   [description]
   * @param  {[type]} className [description]
   * @return {[type]}           [description]
   */


  function removeClass(eleList, className) {
    for (var i = 0; i < eleList.length; i++) {
      if (Util$1.paramType(eleList[i].className) === 'String') {
        eleList[i].className = eleList[i].className.replace(Util$1.trim(className), '');
      }
    }
  }
  /**
   * [addClass description] 增加单个Class
   * @param {[type]} ele       [description]
   * @param {[type]} className [description]
   */


  function addClass(ele, className) {
    ele.className += ' ' + Util$1.trim(className);
  }
  /**
   * [returnMapEle description] 返回所需按钮元素
   * @return {[type]} [description]
   */


  function returnMapEle() {
    var areaEle = document.getElementById('ARK_HEATMAP_HEAD');
    var heatmapTab = document.getElementById('ARKSHOWPOINT');
    var elementMapTab = document.getElementById('ARKSHOWELE');
    var depthMapTab = document.getElementById('ARKSHOWDEP');
    var elementListBtn = document.getElementById('ARK_CONTENT_ELEMENT');
    var elementList = document.getElementById('ARK_SETTING_CONTENT_ELEMENT_LIST');
    var settingBtn = document.getElementById('ARK_SETTING');
    var settingList = document.getElementById('ARK_SETTING_LIST');
    var depthSwitchBtn = document.getElementById('ARK_DEELP_SWITCH');
    var switchBtn = document.getElementById('ARK_HEATMAP_SWITCH_BOX');
    var heatSwitch = document.getElementById('ARK_HEATMAP_SWITCH');
    var leftBtn = document.getElementById('ARK_RANGE_TWO_SLIDER_LEFT');
    var rightBtn = document.getElementById('ARK_RANGE_TWO_SLIDER_RIGHT');
    var leftBg = document.getElementById('ARK_RANGE_TWO_BG_LEFT');
    var rightBg = document.getElementById('ARK_RANGE_TWO_BG_RIGHT');
    var rangeBg = document.getElementById('ARK_RANGE_TWO_BG');
    var rangeEle = document.getElementById('ARK_RANGE_TWO');
    var opacityBtn = document.getElementById('ARK_RANGE_ONE');
    var sliderBg = document.getElementById('ARK_RANGE_ONE_BG');
    var sliderBtn = document.getElementById('ARK_RANGE_ONE_SLIDER');
    var numEle = document.getElementById('ARK_RANGE_ONE_NUM');
    var contentBtn = document.getElementById('ARK_CONTENT_SETTING');
    var contentList = document.getElementById('ARK_SETTING_CONTENT_LIST');
    var openHead = document.getElementById('ARK_OPEN');
    var closeHead = document.getElementById('ARK_CLOSE');
    var refreshBtn = document.getElementById('ARK_REFRESH');
    var crowdsEle = document.getElementById('ARKCONTENTCROWD');
    var conditionsEle = document.getElementById('ARKCONTENTITEM');
    var contentManeEle = document.getElementById('ARK_CONTENT_NAME');
    var noDataEle = document.getElementById('ARK_HEATMAP_HEAT_ARKNODATA');
    var loadingEle = document.getElementById('ARK_HEATMAP_HEAT_ARKLOADING');
    var noDataMSG = document.getElementById('ARK_HEATMAP_noData_MSG');
    var elementMap = document.getElementById('ARK_ELEMENT_MAP');
    var colorRangeEle = document.getElementById('SETTINGCOLOR');
    var bgRangeEle = document.getElementById('SETTINGBG');
    return {
      areaEle: areaEle,
      heatmapTab: heatmapTab,
      elementMapTab: elementMapTab,
      depthMapTab: depthMapTab,
      elementListBtn: elementListBtn,
      settingBtn: settingBtn,
      switchBtn: switchBtn,
      leftBtn: leftBtn,
      rightBtn: rightBtn,
      leftBg: leftBg,
      rightBg: rightBg,
      rangeBg: rangeBg,
      rangeEle: rangeEle,
      opacityBtn: opacityBtn,
      sliderBg: sliderBg,
      sliderBtn: sliderBtn,
      numEle: numEle,
      elementList: elementList,
      settingList: settingList,
      depthSwitchBtn: depthSwitchBtn,
      contentBtn: contentBtn,
      contentList: contentList,
      openHead: openHead,
      closeHead: closeHead,
      refreshBtn: refreshBtn,
      crowdsEle: crowdsEle,
      conditionsEle: conditionsEle,
      contentManeEle: contentManeEle,
      noDataEle: noDataEle,
      loadingEle: loadingEle,
      noDataMSG: noDataMSG,
      elementMap: elementMap,
      heatSwitch: heatSwitch,
      colorRangeEle: colorRangeEle,
      bgRangeEle: bgRangeEle
    };
  }

  function returnBodyEle() {
    var noDataEle = document.getElementById('ARK_HEATMAP_HEAT_ARKNODATA');
    var loadingEle = document.getElementById('ARK_HEATMAP_HEAT_ARKLOADING');
    var noDataMSG = document.getElementById('ARK_HEATMAP_noData_MSG');
    return {
      noDataEle: noDataEle,
      loadingEle: loadingEle,
      noDataMSG: noDataMSG
    };
  }
  /**
   * [creatSettingEle description]
   * @return {[type]} [description]
   */


  function creatListBtnClick() {
    Util$1.addEvent(headBtnMap.settingBtn, 'click', function (event) {
      if (isParent(event.target, headBtnMap.settingList)) {
        return;
      }

      if (headBtnMap.settingList.style.display === 'block') {
        headBtnMap.settingList.style.display = 'none';
      } else {
        headBtnMap.settingList.style.display = 'block';
      }

      headBtnMap.contentList.style.display = 'none';
      headBtnMap.elementList.style.display = 'none';
    });
    Util$1.addEvent(headBtnMap.contentBtn, 'click', function (event) {
      if (isParent(event.target, headBtnMap.contentList)) {
        return;
      }

      if (headBtnMap.contentList.style.display === 'block') {
        headBtnMap.contentList.style.display = 'none';
      } else {
        headBtnMap.contentList.style.display = 'block';
      }

      headBtnMap.settingList.style.display = 'none';
      headBtnMap.elementList.style.display = 'none';
    });
    Util$1.addEvent(headBtnMap.elementListBtn, 'click', function (event) {
      if (isParent(event.target, headBtnMap.elementList)) {
        return;
      }

      if (headBtnMap.elementList.style.display === 'block') {
        headBtnMap.elementList.style.display = 'none';
      } else {
        headBtnMap.elementList.style.display = 'block';
      }

      headBtnMap.settingList.style.display = 'none';
      headBtnMap.contentList.style.display = 'none';
    });
    Util$1.addEvent(document, 'click', function (event) {
      if (isParent(event.target, [headBtnMap.settingBtn, headBtnMap.settingList, headBtnMap.contentBtn, headBtnMap.contentList, headBtnMap.elementListBtn, headBtnMap.elementList])) {
        return;
      }

      headBtnMap.settingList.style.display = 'none';
      headBtnMap.contentList.style.display = 'none';
      headBtnMap.elementList.style.display = 'none';
    });
  }
  /**
   * [creatRangeElement description] 初始化滑块操作
   * @return {[type]} [description]
   */


  function creatRangeElement() {
    headBtnMap.leftBtn.style.left = 0;
    headBtnMap.leftBtn.style.left = 0;
    headBtnMap.rightBtn.style.right = 0;
    headBtnMap.leftBg.style.width = 0;
    headBtnMap.rightBg.style.width = 0;
  }
  /**
   * [creatBgRangeElement description] 初始化背景透明度滑块
   * @return {[type]} [description]
   */


  function creatBgRangeElement() {
    headBtnMap.sliderBtn.style.left = parseInt(getConstantStyle(headBtnMap.opacityBtn, 'width')) * 0.3 - parseInt(getConstantStyle(headBtnMap.sliderBtn, 'width')) / 2 + 'px';
    headBtnMap.sliderBg.style.width = parseInt(getConstantStyle(headBtnMap.opacityBtn, 'width')) * 0.7 + parseInt(getConstantStyle(headBtnMap.sliderBtn, 'width')) / 2 + 'px';
    headBtnMap.numEle.innerHTML = '30%';
    headBtnMap.numEle.style.left = parseInt(getConstantStyle(headBtnMap.opacityBtn, 'width')) * 0.3 - parseInt(getConstantStyle(headBtnMap.numEle, 'width')) / 2 + 'px';
  }
  /**
   * [toggleHead description] 初始化关闭和展开导航条
   * @return {[type]} [description]
   */


  function createToggleHead() {
    function toggleHead() {
      headBtnMap.areaEle.style.top = Math.abs(headBtnMap.areaEle.offsetTop) - headBtnMap.areaEle.clientHeight + 'px';

      if (headBtnMap.openHead.style.display === 'block') {
        headBtnMap.openHead.style.display = 'none';
      } else {
        headBtnMap.openHead.style.display = 'block';
      }
    }

    Util$1.addEvent(headBtnMap.openHead, 'click', toggleHead);
    Util$1.addEvent(headBtnMap.closeHead, 'click', toggleHead);
  }

  function createIframeElement() {
    buildBodyEle();
    headBtnMap = returnBodyEle();
  }
  /**
   * [creatHeadElement description]初始化热图头部导航及操作
   * @return {[type]} [description]
   */


  function creatHeadElement() {
    buildHeadEle();
    headBtnMap = returnMapEle();
    var activeEleList = [headBtnMap.heatmapTab, headBtnMap.elementMapTab, headBtnMap.depthMapTab];

    var heatmapClick = function () {
      if (showMapConfig.type !== 'heatmap') {
        headBtnMap.heatSwitch.checked = true;
      }

      showMapConfig.type = 'heatmap';
      removeClass(activeEleList, 'active');
      addClass(headBtnMap.heatmapTab, 'active');
      headBtnMap.settingBtn.style.display = 'block';
      headBtnMap.elementListBtn.style.display = 'none';
      headBtnMap.switchBtn.style.display = 'block';
      headBtnMap.colorRangeEle.style.display = 'block';
      headBtnMap.bgRangeEle.style.display = 'block';
    };

    Util$1.addEvent(headBtnMap.heatmapTab, 'click', heatmapClick);

    var elementMapClick = function () {
      if (showMapConfig.type !== 'element') {
        headBtnMap.heatSwitch.checked = true;
      }

      showMapConfig.type = 'element';
      removeClass(activeEleList, 'active');
      addClass(headBtnMap.elementMapTab, 'active');
      headBtnMap.elementListBtn.style.display = 'block';
      headBtnMap.settingBtn.style.display = 'block';
      headBtnMap.switchBtn.style.display = 'block';
      headBtnMap.colorRangeEle.style.display = 'none';
      headBtnMap.bgRangeEle.style.display = 'none';
    };

    Util$1.addEvent(headBtnMap.elementMapTab, 'click', elementMapClick);

    var depthMapClick = function () {
      showMapConfig.type = 'depth';
      removeClass(activeEleList, 'active');
      addClass(headBtnMap.depthMapTab, 'active');
      headBtnMap.settingBtn.style.display = 'none';
      headBtnMap.elementListBtn.style.display = 'none';
      headBtnMap.switchBtn.style.display = 'none';
    };

    Util$1.addEvent(headBtnMap.depthMapTab, 'click', depthMapClick);

    if (showMapConfig.type === 'heatmap') {
      heatmapClick();
    } else if (showMapConfig.type === 'element') {
      elementMapClick();
    } else if (showMapConfig.type === 'depth') {
      depthMapClick();
    }

    creatRangeElement();
    creatBgRangeElement();
    creatListBtnClick();
    createToggleHead();
    headBtnMap.areaEle.style.display = 'block';
  }
  /**
   * [initContent description] 初始化过滤条件
   * @param  {[type]} contentText [description]
   * @return {[type]}             [description]
   */


  function initContent() {
    var contentText = showMapConfig.contentText;

    if (Util$1.paramType(contentText) === 'String') {
      try {
        contentText = JSON.parse(contentText);
      } catch (e) {}
    }

    var crowds = contentText.crowds;
    var conditions = contentText.filter.conditions;
    var relation = contentText.filter.relation;
    headBtnMap.crowdsEle.innerHTML = crowds;
    var conditionsHtml = '';

    for (var i = 0; i < conditions.length; i++) {
      conditionsHtml += '<li>' + conditions[i] + '</li>';
    }

    var crowdsNum = 0;

    if (crowds !== '所有用户') {
      crowdsNum = 1;
    }

    if (conditions.length + crowdsNum > 0) {
      headBtnMap.contentManeEle.innerHTML = '过滤条件(' + (conditions.length + crowdsNum) + ')';
    }

    if (conditions.length > 1) {
      conditionsHtml += '<li class="ARK_CONTENT_ITEM_RELATION">' + relation + '</li>';
    }

    if (conditions.length > 0) {
      headBtnMap.conditionsEle.innerHTML = conditionsHtml;
    }
  }

  function setElementMap(list) {
    if (!headBtnMap.elementMap) return;

    if (!list) {
      headBtnMap.elementMap.innerHTML = ' <tr><td></td><td></td><td>无数据</td><td></td><td></td></tr>';
    } else {
      headBtnMap.elementMap.innerHTML = list;
    }
  }

  var heat = null;
  var radius = 15;
  var diffRadius = 5;
  var plugInHeatmapConfig = {
    radius: radius,
    // opacity: .65,
    blur: 1,
    gradient: {
      0: '#3023ae',
      0.2: '#53a0fd',
      0.41: '#b4ec51',
      0.81: '#ffa301',
      1: '#fb0000'
    },
    backgroundColor: 'rgba(0,0,0,0.7)',
    maxOpacity: 0.65,
    minOpacity: 0.2
  };

  function _heat(config) {
    config = config || {};
    this.pointsList = [];
    var ele = Util$1.addEleLable('div', 'ARK_HEATMAP_AREA', 'ARK_HEATMAP_AREA');
    ele.style.width = document.documentElement.scrollWidth + 'px';
    ele.style.height = document.documentElement.scrollHeight + 'px';
    var childEle = Util$1.addEleLable('div', 'ARK_HEATMAP_HEAT', '', ele);
    this.config = Util$1.objMerge({
      container: childEle
    }, config);
    this.heatObj = heatmap.create(this.config);
    return this;
  }

  _heat.prototype.setData = function (pointsList) {
    this.pointsList = pointsList;
    this.heatObj.setData(pointsList);
  };

  _heat.prototype.refresh = function () {
    this.heatObj.repaint();
  };

  _heat.prototype.configure = function (config) {
    this.heatObj.configure(config);
  };

  _heat.prototype.clear = function () {
    this.pointsList = [];
  };

  function getPoints() {
    loadingStatus(true);

    var success = function (data) {
      if (!data || showMapConfig.type !== 'heatmap') return;
      var list = data.datas;
      var code = data.code;

      if (!list || list.length === 0) {
        noDataStatus(0);
        return;
      }

      if (code === 201) {
        noDataStatus(201);
        return;
      }

      if (code === 100) {
        noDataStatus(100);
        return;
      }

      noDataStatus(200);
      var max = 0;
      var len = list.length;
      var points = [];

      for (var i = 0; i < len; i++) {
        var x = list[i].$click_x; //

        var y = list[i].$click_y; // * height / list[i].$page_height

        var eleX = list[i].$element_x;
        var eleY = list[i].$element_y;
        var elePath = list[i].$element_path;

        if (Util$1.paramType(elePath) !== 'String' || Util$1.paramType(eleX) !== 'Number' || Util$1.paramType(eleY) !== 'Number') {
          continue;
        }

        var elePorint = parseEvent(elePath);

        if (!elePorint) {
          continue;
        }

        var elePostion = elementPostion(elePorint);

        if (elePostion.hidden === true) {
          continue;
        }

        var point = {
          x: elePostion.left + eleX,
          y: elePostion.top + eleY,
          value: 1
        };

        if (eleX > elePostion.offsetWidth) {
          point.x = elePostion.left + Math.abs(elePostion.left - x);
        }

        if (eleY > elePostion.offsetHeight) {
          point.y = elePostion.top + Math.abs(elePostion.top - y);
        }

        point.x = parseInt(point.x);
        point.y = parseInt(point.y);
        points.push(point);
      }

      for (var index = 0; index < points.length; index++) {
        for (var z = 0; z < points.length; z++) {
          if (z !== index && radiusPoint(points[index], points[z])) {
            points[index].value += 1;
          }

          max = Math.max(points[index].value, max);
        }
      }

      if (max < showMapConfig.max) {
        max = showMapConfig.max;
      }

      showMapConfig.max = max;
      var pointsObj = {
        max: max,
        min: 0,
        data: points
      };
      heat.setData(pointsObj);

      if (rightDataMax !== 0) {
        heat.heatObj.setDataMax(showMapConfig.max * rightDataMax / 100);
      }
    };

    var param = backParam();
    var url = heatmapConfig.uploadURL + 'ark/sdk/heatmap/click/analysis'; // 'http://192.168.61.119:9090/ark/sdk/heatmap/click/analysis'

    var option = {
      url: url,
      data: param,
      success: success,
      error: function () {
        loadingStatus(false);
        noDataStatus(402);
      }
    };
    new ajax().post(option);
  }

  function radiusPoint(p1, p2) {
    return p1.x - radius - diffRadius <= p2.x && p2.x <= p1.x + radius - diffRadius && p1.y - radius - diffRadius <= p2.y && p2.y <= p1.y + radius - diffRadius;
  }

  function resetGradient(max, min) {
    var colorRange = new ColorRangeMaker({
      color: [[48, 35, 174], [83, 160, 253], [180, 236, 81], [255, 163, 1], [251, 0, 0]],
      value: [0, 100]
    });
    var rangeArea = [0, 0.2, 0.41, 0.81, 1];
    var color = {};
    var DValue = max - min;

    for (var i = 0; i < rangeArea.length; i++) {
      var colorList = colorRange.make(min + rangeArea[i] * DValue);
      var rgb = 'rgb(' + colorList.join(',') + ')';
      color[rangeArea[i]] = rgb;
    }

    return color;
  }

  function setColorRange() {
    var colorList = resetGradient(changeMaxNum, changeMinNum);
    heat.heatObj.configure({
      gradient: colorList
    });
  }

  var rightDataMax = 0;
  var changeMaxNum = 100;
  var changeMinNum = 0;

  function rightColorRange(e) {
    e = e || window.event;
    e.stopPropagation(); // e.preventDefault();
    // e.stopPropagation();

    var clickX = (e || window.event).clientX;
    var leftX = parseInt(getConstantStyle(headBtnMap.leftBtn, 'left'));
    var rightX = parseInt(getConstantStyle(headBtnMap.rightBtn, 'left'));
    var rangeWidth = headBtnMap.rangeEle.offsetWidth;
    var leftWidth = headBtnMap.leftBtn.offsetWidth;
    var rightWidth = headBtnMap.rightBtn.offsetWidth;
    var minRightX = leftX + leftWidth;
    var rangMax = 100;

    function moveRightBtn(e) {
      e.preventDefault();
      e.stopPropagation();
      var moveX = (e || window.event).clientX;
      var right = rightX + moveX - clickX;
      var positionX = Math.max(minRightX, Math.min(right, rangeWidth - rightWidth));
      headBtnMap.rightBtn.style.left = positionX + 'px';
      headBtnMap.rightBg.style.width = rangeWidth - positionX + 'px';
      headBtnMap.rangeBg.style.width = positionX + 'px';
      rangMax = parseInt(positionX / (rangeWidth - rightWidth) * 100) / 100 * 100;
    }

    function upRightBtn(e) {
      e = e || window.event;
      e.stopPropagation();
      Util$1.removeEvent(document, 'mousemove', moveRightBtn);
      Util$1.removeEvent(document, 'mouseup', upRightBtn); // setColorRange()
      //

      rightDataMax = rangMax - changeMinNum;
      heat.heatObj.setDataMax(showMapConfig.max * rightDataMax / 100);
      headBtnMap.rightBtn.releaseCapture && headBtnMap.rightBtn.releaseCapture();
      return false;
    }

    Util$1.addEvent(document, 'mousemove', moveRightBtn);
    Util$1.addEvent(document, 'mouseup', upRightBtn);
    this.setCapture && this.setCapture();
    return false;
  }

  function leftColorRange(e) {
    e = e || window.event;
    e.stopPropagation(); // e.preventDefault();
    // e.stopPropagation();

    var clickX = (e || window.event).clientX;
    var leftX = parseInt(getConstantStyle(headBtnMap.leftBtn, 'left'));
    var rightX = parseInt(getConstantStyle(headBtnMap.rightBtn, 'left'));
    var rangeWidth = headBtnMap.rangeEle.offsetWidth;
    var leftWidth = headBtnMap.leftBtn.offsetWidth;
    var rightWidth = headBtnMap.rightBtn.offsetWidth;
    var maxLeftX = Math.min(rightX, rangeWidth - rightWidth);

    function moveLeftBtn(e) {
      e.preventDefault();
      e.stopPropagation();
      var moveX = (e || window.event).clientX;
      var left = leftX ? leftX + moveX - clickX : moveX - clickX;
      var positionX = Math.max(0, Math.min(maxLeftX - rightWidth, left + leftWidth));
      headBtnMap.leftBtn.style.left = positionX + 'px';
      headBtnMap.leftBg.style.width = positionX + 'px';

      changeMinNum = parseInt(positionX / (rangeWidth - rightWidth) * 100) / 100 * 100;
    }

    function upLeftBtn(e) {
      e = e || window.event;
      e.stopPropagation();
      Util$1.removeEvent(document, 'mousemove', moveLeftBtn);
      Util$1.removeEvent(document, 'mouseup', upLeftBtn);
      headBtnMap.leftBtn.releaseCapture && headBtnMap.leftBtn.releaseCapture();
      setColorRange();
    }

    Util$1.addEvent(document, 'mousemove', moveLeftBtn);
    Util$1.addEvent(document, 'mouseup', upLeftBtn);
    this.setCapture && this.setCapture();
    return false;
  }

  var opacityNum = 0.3;

  function setHeatmapOpacity(num) {
    if (Util$1.paramType(num) === 'Number') {
      opacityNum = num;
    }

    if (opacityNum > 1) {
      opacityNum = opacityNum / 100;
    }

    var opacity = 1 - opacityNum;
    var backgroundColor = opacity !== 0 ? 'rgba(0,0,0,' + opacity + ')' : 'transparent';
    heat.heatObj.configure({
      backgroundColor: backgroundColor
    });
  }

  function bgColorRange(e) {
    e = e || window.event;
    e.stopPropagation();
    var clickX = (e || window.event).clientX;
    var sliderBtnX = parseInt(getConstantStyle(headBtnMap.sliderBtn, 'left'));
    var rangeWidth = headBtnMap.opacityBtn.offsetWidth;
    var sliderWidth = headBtnMap.sliderBtn.offsetWidth;
    var numWidth = headBtnMap.numEle.offsetWidth;
    var minLeftX = 0;

    function moveBtn(e) {
      e.preventDefault();
      e.stopPropagation();
      var moveX = (e || window.event).clientX;
      var right = sliderBtnX + moveX - clickX;
      var positionX = Math.max(minLeftX, Math.min(right, rangeWidth - sliderWidth));
      headBtnMap.sliderBtn.style.left = positionX + 'px';
      headBtnMap.sliderBg.style.width = rangeWidth - positionX + 'px';
      headBtnMap.numEle.style.left = positionX - numWidth / 2 + sliderWidth / 2 + 'px';
      opacityNum = parseInt(positionX / (rangeWidth - sliderWidth) * 100) / 100;
      headBtnMap.numEle.innerHTML = parseInt(opacityNum * 100) + '%';
    }

    function upBtn(e) {
      e = e || window.event;
      e.stopPropagation();
      Util$1.removeEvent(document, 'mousemove', moveBtn);
      Util$1.removeEvent(document, 'mouseup', upBtn);
      headBtnMap.sliderBtn.releaseCapture && headBtnMap.sliderBtn.releaseCapture();
      setHeatmapOpacity();
    }

    Util$1.addEvent(document, 'mousemove', moveBtn);
    Util$1.addEvent(document, 'mouseup', upBtn);
    this.setCapture && this.setCapture();
    return false;
  }

  function createColorRange() {
    Util$1.addEvent(headBtnMap.leftBtn, 'mousedown', leftColorRange);
    Util$1.addEvent(headBtnMap.rightBtn, 'mousedown', rightColorRange);
    Util$1.addEvent(headBtnMap.sliderBtn, 'mousedown', bgColorRange); // Util.addEvent(leftBtn, 'mouseup', upLeftBtn)
    // Util.addEvent(rightBtn, 'mousemove', moveLeftBtn)
    // Util.addEvent(rightBtn, 'mouseup', upLeftBtn)
    // Util.addEvent(opacityBtn, 'mousemove', moveLeftBtn)
    // Util.addEvent(opacityBtn, 'mouseup', upLeftBtn)
  }

  function heatmap$1() {
    heat = new _heat(plugInHeatmapConfig);

    if (!Util$1.isEmptyObject(showMapConfig.content)) {
      getPoints();
    } else {
      noDataStatus(400);
    }
  }

  function clearHeatmap() {
    var dom = document.getElementById('ARK_HEATMAP_AREA');

    if (dom) {
      dom.parentNode.removeChild(dom);
      heat.clear();
      heat = null;
    }

    noDataStatus(200);
    loadingStatus(false);
  }

  function changeColorRange(dataObj) {
    changeMinNum = Util$1.paramType(dataObj.min) !== 'Number' ? changeMinNum : dataObj.min;
    setColorRange();
    var maxValue = Util$1.paramType(dataObj.max) !== 'Number' ? rightDataMax : dataObj.max;

    if (maxValue) {
      heat.heatObj.setDataMax(showMapConfig.max * maxValue / 100);
    }
  }

  var css_248z$1 = ".ARK_PAGE_LINE_BOX {\n    z-index: 5002;\n    position: absolute;\n    width: 100%;\n    height: 1px;\n    /*overflow-x:hidden;*/\n}\n\n.ARK_PAGE_LINE_LINE {\n    width: 100%;\n    height: 0px;\n    border-bottom: dashed 1px #262d39;\n}\n\n.ARK_PAGE_LINE_VALUE {\n    /*width: 76px;\n\theight: 32px;*/\n    background-color: #262d39;\n    font-family: Roboto-Bold;\n    font-size: 16px;\n    font-weight: normal;\n    font-stretch: normal;\n    line-height: 16px;\n    letter-spacing: 0px;\n    color: #ffffff;\n    padding: 8px 16px;\n    border-radius: 0 4px 0 0;\n    -moz-border-radius: 0 4px 0 0;\n    position: absolute;\n    left: 0;\n    bottom: 0;\n}\n\n.ARK_MOUSE_LINE_VALUE {\n    position: relative; \n    left: -50%;\n    text-align: center;\n    padding: 8px 16px;\n    border-radius: 4px;\n    -moz-border-radius: 4px;\n    background-color: #262d39;\n    font-family: Roboto-Bold;\n    font-size: 16px;\n    font-weight: normal;\n    font-stretch: normal;\n    line-height: 16px;\n    letter-spacing: 0px;\n    color: #ffffff;\n}\n.ARK_MOUSE_LINE_LINE{\n\t border-bottom: solid 1px #262d39;\n}\n.ARK_MOUSE_LINE_VALUE_BOX{\n\t    left: 50%;\n\t    position: absolute;\n\t    top:-16px; \n}";
  styleInject(css_248z$1);

  var webStayPageLineTemp = `<div class="ARK_PAGE_LINE_LINE"></div><div class="ARK_PAGE_LINE_VALUE">{LINENUM}%</div>
`;
  var webStayMouseLineTemp = `<div class="ARK_PAGE_LINE_LINE ARK_MOUSE_LINE_LINE"></div><div class="ARK_MOUSE_LINE_VALUE_BOX"><div class=" ARK_MOUSE_LINE_VALUE" id="ARK_MOUSE_LINE_VALUE"></div></div>
`;

  var webStayDatas = {};

  function setMouseLine(event) {
    var e = event || window.event;
    var scrollY = document.documentElement.scrollTop || document.body.scrollTop;
    var y = e.pageY || e.clientY + scrollY;
    var lineNum = Math.floor(y / 10);
    var detail = webStayDatas.detail || [];

    if (detail.length === 0) {
      return;
    }

    var uv = webStayDatas.uv;
    var value = 0;

    if (lineNum < detail.length) {
      value = Math.ceil(detail[lineNum] / uv * 10000) / 100;
    }

    var mouseLineEle = document.getElementById('ARKMOUSELINE');

    if (!mouseLineEle) {
      mouseLineEle = Util$1.addEleLable('div', 'ARK_PAGE_LINE_BOX', 'ARKMOUSELINE', document.body);
      mouseLineEle.innerHTML = webStayMouseLineTemp;
    }

    document.getElementById('ARK_MOUSE_LINE_VALUE').innerHTML = value + '%的人浏览到了这里';
    mouseLineEle.style.top = y + 5 + 'px';
  } // var noDataStatus = false


  var isDepth = false;

  function setline(data) {
    webStayDatas = data.datas;

    if (showMapConfig.type === 'depth') {
      loadingStatus(false);
    }

    if (showMapConfig.type === 'depth') {
      if (data.code === 0 && (!webStayDatas || webStayDatas.detail && webStayDatas.detail.length === 0)) {
        noDataStatus(0);
        return;
      } // return


      if (data.code === 201 && isDepth) {
        noDataStatus(201);
        return;
      }

      if (data.code === 100) {
        noDataStatus(100);
        return;
      }

      if (data.code === 1302) {
        noDataStatus(1302);
        return;
      }
    }

    var pageHeight = document.documentElement.scrollHeight;
    var lineList = webStayDatas.detail;
    var uv = webStayDatas.uv;
    // lineList.push()

    for (var i = 0; i < parseInt(pageHeight / 10); i++) {
      // var value = Math.ceil(lineList[i] / uv * 100)
      var value = 0;

      if (Util$1.paramType(lineList[i]) === 'Number') {
        value = Math.ceil(lineList[i] / uv * 10000) / 100;
      }

      var lineEle = null;

      if (i * 10 > pageHeight) {
        break;
      }

      if (i * 10 < 600) {
        if (i > 0 && value !== 100 && lineList[i - 1] === uv) {
          lineEle = Util$1.addEleLable('div', 'ARK_PAGE_LINE_BOX', '', document.body); // var lineNum = i - 1 < 0 ? 0 : (i - 1)

          lineEle.style.top = i * 10 + 'px';

          lineEle.innerHTML = webStayPageLineTemp.replace('{LINENUM}', 100);
        }
      } else if (i * 10 % 200 === 0) {
        lineEle = Util$1.addEleLable('div', 'ARK_PAGE_LINE_BOX', '', document.body); // var lineNum = i - 1 < 0 ? 0 : (i - 1)

        lineEle.style.top = i * 10 + 'px';

        lineEle.innerHTML = webStayPageLineTemp.replace('{LINENUM}', value);
      }
    }

    Util$1.removeEvent(document, 'mousemove', setMouseLine);
    Util$1.addEvent(document, 'mousemove', setMouseLine);
  }

  function removeLineEvent() {
    Util$1.removeEvent(document, 'mousemove', setMouseLine);
  }

  function removeLine() {
    var lineEleList = document.getElementsByClassName('ARK_PAGE_LINE_BOX');

    if (lineEleList.length > 0) {
      while (lineEleList.length > 0) {
        lineEleList[0].parentNode.removeChild(lineEleList[0]);
      }
    }
  }

  function clearWebStay() {
    removeLine();
    removeLineEvent();

    if (showMapConfig.type === 'depth') {
      noDataStatus(200);
      loadingStatus(false);
    }
  }

  function initWebStay() {
    if (showMapConfig.type === 'depth') {
      loadingStatus(true);
    }

    var param = backParam();
    var option = {
      url: heatmapConfig.uploadURL + 'ark/sdk/heatmap/scrollreach/analysis',
      data: param,
      success: setline,
      error: function () {
        loadingStatus(false);

        if (showMapConfig.type === 'depth') {
          noDataStatus(402);
        }
      }
    };
    new ajax().post(option);
  }

  var elementMapDatas = {};
  var colors = ['63,81,181', '33,150,243', '0,188,212', '87,201,92', '205,220,57', '255,235,59', '255,152,0', '255,87,34', '229,57,53', '183,28,28'];

  function thousands(num) {
    var str = num.toString();
    var reg = str.indexOf('.') > -1 ? /(\d)(?=(\d{3})+\.)/g : /(\d)(?=(?:\d{3})+$)/g;
    return str.replace(reg, '$1,');
  }

  function buildElemetMap(ele, elementObj, index) {
    var uv = elementObj.uv;
    var pv = elementObj.clickNum;
    var pvPercent = Math.round(elementObj.clickNumPercent * 10000) / 100;
    var elePorint = ele;
    var eleWidth = elePorint.offsetWidth + 10;
    var eleHeight = elePorint.offsetHeight + 10;
    var elePosition = elementPostion(elePorint);

    if (elePosition.hidden === true) {
      return;
    }

    var parent = elePorint.parentNode || document.body; // var ele_parent_position = elementPostion(parent)

    var eleContext = getElementContent(elePorint);
    elementObj.clickNumPercent = pvPercent;
    elementObj.content = eleContext || '-';
    var top = elePorint.offsetTop - 5; // ele_position.y - ele_parent_position.y

    var left = elePorint.offsetLeft - 5; // ele_position.x - ele_parent_position.x
    // if (pvPercent != 1) {

    var colorIndex = Math.ceil(pv / max * 10) - 1; // }

    if (eleWidth < 55) {
      eleWidth = 55;
    }

    var color = colors[colorIndex];
    var eleDiv = document.createElement('div'); // var ele_css = 'top: ' + top + 'px;left: ' + left + 'px;background-color:rgba(' + color + ',.8);width:' + ele_width + 'px;height:' + ele_height + 'px;line-height:' + ele_height + 'px;text-align:center;' //'

    eleDiv.style.top = top + 'px';
    eleDiv.style.left = left + 'px';
    eleDiv.style.backgroundColor = 'rgba(' + color + ',.8)';
    eleDiv.style.width = eleWidth + 'px';
    eleDiv.style.height = eleHeight + 'px';
    eleDiv.style.lineHeight = eleHeight + 'px';
    eleDiv.style.textAlign = 'center';
    var classList = 'ARK_HEAT_ELEMENT_POINT';

    if (index > 19) {
      classList += ' ARK_OPACITY';
    }

    eleDiv.className = classList;
    var pageHeight = document.body.offsetHeight;
    var status = '';
    var topPorint = 'top:' + (eleHeight + 6) + 'px;';

    if (pageHeight < eleWidth + elePorint.offsetTop + 78) {
      status = 'up';
      topPorint = 'top: -82px;';
    }

    var chlidHtml = '<span>' + pvPercent + `%</span>
                <div class="ARK_HEAT_ELEMENT_POINT_MSG ` + status + '" style="' + topPorint + `">
                    <div class="ARROWLIST"></div>
                    <table>
                        <thead>
                            <td>点击数</td>
                            <td>点击占比</td>
                        </thead>
                        <tbody>
                            <tr>
                                <td>` + thousands(pv) + `</td>
                                <td>` + pvPercent + `%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
    `;
    eleDiv.innerHTML = chlidHtml;

    eleDiv.onclick = function (event) {
      window.event ? window.event.cancelBubble = true : event.stopPropagation();
      event.preventDefault();
      return false;
    };

    parent.appendChild(eleDiv);

    var hoverCallback = function () {
      return function () {
        var top = this.offsetTop - 5; // ele_position.y - ele_parent_position.y

        var left = this.offsetLeft - 5; // ele_position.x - ele_parent_position.x

        eleDiv.style.top = top;
        eleDiv.style.left = left; // ele_div.style = 'top: ' + top + 'px;left: ' + left + 'px;background-color:rgba(' + color + ',.7);width:' + ele_width + 'px;height:' + ele_height + 'px;line-height:' + ele_height + 'px;text-align:center;'
      };
    }();

    Util$1.addEvent(ele, 'mouseover', hoverCallback);
    return `<tr>
                <td title="` + eleContext + '" ' + (eleContext ? '' : 'style="color:#BBBBBB"') + '>' + (eleContext || '-') + `</td>
                <td>` + elementObj.type + `</td>
                <td>` + uv + `</td>
                <td>` + thousands(pv) + `</td>
                <td>` + pvPercent + `%</td>
            </tr>`;
  }

  var max = 0;

  function setElmentMap(data) {
    if (showMapConfig.type !== 'element') return;
    loadingStatus(false);
    elementMapDatas = data.datas;

    if (data.code === 0 && (!elementMapDatas || elementMapDatas.detail && elementMapDatas.detail.length === 0)) {
      noDataStatus(0);
      setElementMap();
      return;
    } // return


    if (data.code === 201) {
      noDataStatus(201);
      setElementMap();
      return;
    }

    if (data.code === 100) {
      noDataStatus(100);
      setElementMap();
      return;
    }

    var elementList = elementMapDatas.detail; // var uv = data.datas.uv

    if (!elementList || elementList.length === 0) {
      noDataStatus(0);
      setElementMap();
      return;
    }

    var maxList = 0;
    var eleList = [];
    var eleMsg = [];
    max = 0;

    for (var i = 0; i < elementList.length; i++) {
      var path = elementList[i].path;

      if (!path) {
        continue;
      }

      var elePorint = parseEvent(path);

      if (elePorint) {
        if (eleList.indexOf(elePorint) > -1) {
          eleMsg[eleList.indexOf(elePorint)].clickNum += Number(elementList[i].clickNum) || 0;
          eleMsg[eleList.indexOf(elePorint)].uv += Number(elementList[i].uv) || 0;
          eleMsg[eleList.indexOf(elePorint)].clickNumPercent += Number(elementList[i].pvPercent) || 0;
          eleMsg[eleList.indexOf(elePorint)].uvPercent += Number(elementList[i].uvPercent) || 0;

          if (eleMsg[eleList.indexOf(elePorint)].clickNum > max) {
            max = eleMsg[eleList.indexOf(elePorint)].clickNum;
          }
        } else {
          eleList.push(elePorint);
          eleMsg.push({
            clickNum: Number(elementList[i].clickNum) || 0,
            uv: Number(elementList[i].uv) || 0,
            clickNumPercent: Number(elementList[i].clickNumPercent) || 0,
            uvPercent: Number(elementList[i].uvPercent) || 0,
            type: elementList[i].type
          });
        }

        if (elementList[i].clickNum > max) {
          max = elementList[i].clickNum;
        }
      }
    }

    if (eleList.length > 0) {
      eleList.sort(function (a, b) {
        return a.clickNum - b.clickNum;
      });
    } else {
      noDataStatus(0);
      setElementMap();
      return;
    }

    var eleMessageList = [];

    for (var index = 0; index < eleList.length; index++) {
      var listHtml = buildElemetMap(eleList[index], eleMsg[index], maxList);

      if (!listHtml) {
        continue;
      }

      if (maxList < 20) {
        elementList += listHtml;
        eleMessageList.push(eleMsg[index]);
      }

      maxList++;
    }

    setElementMap(elementList);

    if (eleMessageList.length > 0) {
      window.parent.postMessage(JSON.stringify({
        code: 'ark/elementList',
        elementList: eleMessageList
      }), '*');
    }
  }

  function showElementMap() {
    loadingStatus(true);
    var param = backParam();
    var option = {
      url: heatmapConfig.uploadURL + 'ark/sdk/heatmap/element/analysis',
      data: param,
      success: setElmentMap,
      error: function () {
        noDataStatus(402);
      }
    };
    new ajax().post(option);
  }

  function getClassNames(classStr, tagName) {
    if (document.getElementsByClassName) {
      return document.getElementsByClassName(classStr);
    } else {
      var nodes = document.getElementsByTagName(tagName);
      var ret = [];

      for (var i = 0; i < nodes.length; i++) {
        if (nodes[i] && nodes[i].className.indexOf(classStr) > -1) {
          ret.push(nodes[i]);
        }
      }

      return ret;
    }
  }

  function delElementMap() {
    var elementEleList = getClassNames('ARK_HEAT_ELEMENT_POINT', 'div');

    if (elementEleList.length > 0) {
      while (elementEleList.length > 0) {
        elementEleList[0].parentNode.removeChild(elementEleList[0]);
      }
    }

    noDataStatus(200);
    loadingStatus(false);
  }

  var isInitHeatmap = false;
  /**
   * [processMsg description]过滤符合热图消息规则的iframe 消息，且在页面未加载完毕时，保存所收取消息
   * @param  {[type]} msg [description] iframe 消息
   * @return {[type]}     [description]
   */

  function processMsg(msg) {
    if (msg.code === 'ark/heatmap' || msg.code === 'ark/depth' || msg.code === 'ark/element' || msg.code === 'ark/attention') {
      if (!isInitHeatmap) {
        ifarmeMessageList.push(msg);
      } else {
        showIframeMap(msg);
      }
    }
  }
  /**
   * [clearMap description] tab切换重置无关页面
   * @return {[type]} [description]
   */


  function clearMap() {
    // if (msg.code !== 'ark/heatmap') {
    clearHeatmap();
    clearWebStay();
    delElementMap(); // }
  }

  var isWebstayShow = false;

  function showIframeMap(msg) {
    if (ifarmeMessageList.length > 0) {
      for (var i = ifarmeMessageList.length - 1; i >= 0; i--) {
        showMap(ifarmeMessageList[i]);
      }
    }

    showMapConfig.content = msg.content;

    if (showMapConfig.content.appKey !== heatmapConfig.appid) {
      noDataStatus(500);
      return;
    }

    var control = msg.control;
    var type = control.type;
    showMapConfig.control = control;

    if (msg.code === 'ark/heatmap') {
      if (showMapConfig.type !== 'heatmap') {
        isMapClose = false;
        clearMap();
      }

      showMapConfig.type = 'heatmap';

      if (control.type === 'openHeatMap') {
        isMapClose = false;
        heatmap$1();

        if (showMapConfig.control && showMapConfig.control.value && Util$1.paramType(showMapConfig.control.value.min) === 'Number') {
          changeColorRange({
            min: showMapConfig.control.value.min,
            max: showMapConfig.control.value.maxValue
          });
          setHeatmapOpacity(showMapConfig.control.value.opacity);
        }
      } else if (type === 'closeHeatMap') {
        isMapClose = true;
        clearHeatmap();
      } else if (type === 'openDepth') {
        isWebstayShow = true;
        initWebStay();
      } else if (type === 'closeDepth') {
        isWebstayShow = false;
        clearWebStay();
      } else if (type === 'refresh' || type === 'getHeatmapData') {
        refreshBtnClick();
      } else if (type === 'heatmapcolorRange') {
        changeColorRange({
          min: control.value.min,
          max: control.value.maxValue
        });
      } else if (type === 'heatmapOpacity') {
        setHeatmapOpacity(control.value.opacity);
      }
    }

    if (msg.code === 'ark/depth') {
      if (showMapConfig.type !== 'depth') {
        clearMap();
      }

      showMapConfig.type = 'depth';

      if (type === 'openDepth') {
        initWebStay();
      } else if (type === 'closeDepth') {
        clearWebStay();
      } else if (type === 'refresh') {
        refreshBtnClick();
      }
    }

    if (msg.code === 'ark/element') {
      if (showMapConfig.type !== 'element') {
        isMapClose = false;
        clearMap();
      }

      showMapConfig.type = 'element';

      if (type === 'openHeatMap' || type === 'openElementMap') {
        isMapClose = false;
        showElementMap();
      } else if (type === 'closeHeatMap' || type === 'closeElementMap') {
        isMapClose = true;
        delElementMap();
      } else if (type === 'openDepth') {
        isWebstayShow = true;
        initWebStay();
      } else if (type === 'closeDepth') {
        isWebstayShow = false;
        clearWebStay();
      } else if (type === 'refresh') {
        refreshBtnClick();
      } else if (type === 'getElmentData') {
        refreshPoints();
      }
    } // if (msg.code === 'ark/attention') {
    // }

  }

  function setMapType(msg) {
    if (msg.code === 'ark/heatmap') {
      showMapConfig.type = 'heatmap';
    }

    if (msg.code === 'ark/depth') {
      showMapConfig.type = 'depth';
    }

    if (msg.code === 'ark/element') {
      showMapConfig.type = 'element';
    }

    if (msg.code === 'ark/attention') {
      showMapConfig.type = 'attention';
    }
  }
  /**
   * [showMap description]根据消息或url参数展示对应热图
   * @return {[type]} [description]
   */


  function showMap(msg) {
    if (msg.code === 'ark/heatmap') {
      heatmap$1();
    }

    if (msg.code === 'ark/depth') {
      initWebStay();
    }

    if (msg.code === 'ark/element') {
      showElementMap();
    } // if (msg.code === 'ark/attention') {
    // }

  }
  /**
   * [creatHeadTabBntClick description]交互式时初始化头部按钮事件
   * @return {[type]} [description]
   */


  var isMapClose = false;

  function creatHeadTabBntClick() {
    Util$1.addEvent(headBtnMap.heatmapTab, 'click', refreshPoints);
    Util$1.addEvent(headBtnMap.elementMapTab, 'click', refreshPoints);
    Util$1.addEvent(headBtnMap.depthMapTab, 'click', refreshPoints);
    Util$1.addEvent(headBtnMap.refreshBtn, 'click', refreshBtnClick);
    Util$1.addEvent(headBtnMap.heatSwitch, 'click', function (event) {
      if (event.target.checked === false) {
        isMapClose = true;

        if (showMapConfig.type === 'element') {
          delElementMap();
        } else if (showMapConfig.type === 'heatmap') {
          clearHeatmap();
        }

        if (headBtnMap.depthSwitchBtn.checked === true) {
          clearWebStay();
        }
      } else {
        isMapClose = false;

        if (showMapConfig.type === 'element') {
          showElementMap();
        } else if (showMapConfig.type === 'heatmap') {
          heatmap$1();
        }

        if (headBtnMap.depthSwitchBtn.checked === true) {
          initWebStay();
        }
      }
    });
    Util$1.addEvent(headBtnMap.depthSwitchBtn, 'click', function () {
      if (headBtnMap.depthSwitchBtn.checked === false) {
        clearWebStay();
      } else {
        initWebStay();
      }
    });
    createColorRange();
  }
  /**
   * [initHeatmap description]初始化热图并建立通讯
   * @return {[type]} [description]
   */


  function initHeatmap() {
    if (isElmentReady()) {
      if (isEmbedded('arkheatmap')) {
        createIframeElement();
        isInitHeatmap = true;
        sendMsg();
        getMsg(processMsg);
      } else if (document.readyState === 'complete') {
        var arkcontent = Util$1.GetUrlParam('arkcontent');
        var arkcontentText = Util$1.GetUrlParam('arkcontentText');
        arkcontent = pipParam(pipParam(arkcontent, '/'), '#');

        if (!arkcontent) {
          noDataStatus(400);
          return;
        }

        try {
          var params = unescape(arkcontent);
          showMapConfig.content = JSON.parse(params);
        } catch (e) {
          creatHeadTabBntClick();
          noDataStatus(400);
          return;
        }

        if (!Util$1.isEmptyObject(showMapConfig.content)) {
          setMapType(showMapConfig.content);
        }

        creatHeadElement();
        creatHeadTabBntClick();

        if (showMapConfig.content.appKey !== heatmapConfig.appid) {
          noDataStatus(500);
          return;
        }

        showMap(showMapConfig.content);

        if (arkcontentText) {
          try {
            arkcontentText = pipParam(pipParam(arkcontentText, '/'), '#');
            var testParams = unescape(arkcontentText);
            showMapConfig.contentText = JSON.parse(testParams);
            initContent();
          } catch (e) {}
        }
      } else {
        setTimeout(initHeatmap, 20);
        return;
      }

      Util$1.addEvent(window, 'resize', resizeHeatmap);
    } else {
      setTimeout(initHeatmap, 20);
    }
  }

  function refreshPoints() {
    if (headBtnMap.heatSwitch && headBtnMap.heatSwitch.checked === true) {
      isMapClose = false;
    }

    if (isMapClose === true && (showMapConfig.type === 'heatmap' || showMapConfig.type === 'element')) {
      return;
    }

    clearMap();

    if (showMapConfig.content.appKey !== heatmapConfig.appid) {
      noDataStatus(500);
      return;
    }

    if (!showMapConfig.content) {
      noDataStatus(400);
      return;
    }

    if (showMapConfig.type === 'heatmap') {
      heatmap$1();
      var min = null;
      var max = null;
      var opt = null;

      if (showMapConfig.control && showMapConfig.control.value && showMapConfig.control.value.min) {
        min = showMapConfig.control.value.min;
        max = showMapConfig.control.value.maxValue;
        opt = showMapConfig.control.value.opacity;
      }

      changeColorRange({
        min: min,
        max: max
      });
      setHeatmapOpacity(opt);
    } else if (showMapConfig.type === 'element') {
      showElementMap();
    }

    if (showMapConfig.type === 'depth' || headBtnMap.depthSwitchBtn && headBtnMap.depthSwitchBtn.checked === true) {
      initWebStay();
    }

    if (isWebstayShow === true) {
      initWebStay();
    }
  }

  function refreshBtnClick() {
    showMapConfig.isRefresh = true;
    refreshPoints();
    showMapConfig.isRefresh = false;
  }

  var resizeTimer = null;
  var windowHeight = document.documentElement.clientHeight || document.body.clientHeight;

  function resizeHeatmap() {
    var changeHeight = document.documentElement.clientHeight || document.body.clientHeight;

    if (windowHeight !== changeHeight) {
      windowHeight = changeHeight;
    } else {
      clearTimeout(resizeTimer);
      refreshPoints();
      return;
    }

    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(resizeHeatmap, 1000);
  }

  initHeatmap();

})));
